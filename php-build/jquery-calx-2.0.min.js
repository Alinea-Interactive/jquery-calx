(function(s){function C(f){function k(){this.yy={}}var l={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,"=":11,"+":12,"(":13,")":14,"[":15,expseq:16,"]":17,"<":18,">":19,NOT:20,"-":21,"*":22,"/":23,"^":24,E:25,FUNCTION:26,cell:27,FIXEDCELL:28,":":29,CELL:30,SHEET:31,";":32,",":33,VARIABLE:34,DECIMAL:35,NUMBER:36,"%":37,"#":38,"!":39,$accept:0,$end:1},terminals_:{5:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"=",12:"+", 13:"(",14:")",15:"[",17:"]",18:"<",19:">",20:"NOT",21:"-",22:"*",23:"/",24:"^",25:"E",26:"FUNCTION",28:"FIXEDCELL",29:":",30:"CELL",31:"SHEET",32:";",33:",",34:"VARIABLE",35:"DECIMAL",36:"NUMBER",37:"%",38:"#",39:"!"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,1],[4,3],[4,4],[4,1],[4,1],[4,2],[27,1],[27,3],[27,1],[27,3],[27,3],[27,5],[16,1],[16,3],[16,3],[6,1],[6,3],[9,1],[9,3],[9,2],[2,3], [2,4]],performAction:function(e,g,k,b,l,m,n){e=m.length-1;switch(l){case 1:return m[e-1];case 2:this.$=f.getVariable(m[e]);break;case 3:this.$=f.time(m[e]);break;case 4:this.$=f.time(m[e]);break;case 5:this.$=1*m[e];isNaN(this.$)&&(this.$=0);break;case 6:this.$=m[e].substring(1,m[e].length-1);break;case 7:this.$=f.comparator.equal(m[e-2],m[e]);break;case 8:this.$=m[e-2].getFloatValue()+m[e].getFloatValue();break;case 9:this.$=1*m[e-1];break;case 10:this.$=m[e-1];break;case 11:this.$=f.comparator.lessEqual(m[e- 3],m[e-1]);break;case 12:this.$=f.comparator.greaterEqual(m[e-3],m[e-1]);break;case 13:this.$=1*m[e-3]!=1*m[e];break;case 14:this.$=m[e-2]!=m[e];break;case 15:this.$=f.comparator.greater(m[e-2],m[e]);break;case 16:this.$=f.comparator.less(m[e-2],m[e]);break;case 17:this.$=1*m[e-2]-1*m[e];break;case 18:this.$=1*m[e-2]*m[e];break;case 19:this.$=0==1*m[e]?"#DIV/0!":1*m[e-2]/(1*m[e]);break;case 20:this.$=Math.pow(1*m[e-2],1*m[e]);break;case 21:this.$=-1*m[e];isNaN(this.$)&&(this.$=0);break;case 22:this.$= 1*m[e];isNaN(this.$)&&(this.$=0);break;case 23:this.$=Math.E;break;case 24:this.$=f.callFunction(m[e-2]);break;case 25:this.$=f.callFunction(m[e-3],m[e-1]);break;case 29:this.$=f.getCell(m[e]);break;case 30:this.$=f.getCellRange(m[e-2],m[e]);break;case 31:this.$=f.getCell(m[e]);break;case 32:this.$=f.getCellRange(m[e-2],m[e]);break;case 33:this.$=f.getRemoteCell(m[e-2],m[e]);break;case 34:this.$=f.getRemoteCellRange(m[e-4],m[e-2],m[e]);break;case 35:this.$=[m[e]];break;case 36:m[e-2].push(m[e]);this.$= m[e-2];break;case 37:m[e-2].push(m[e]);this.$=m[e-2];break;case 38:this.$=[m[e]];break;case 39:this.$=s.isArray(m[e-2])?m[e-2]:[m[e-2]];this.$.push(m[e]);break;case 40:this.$=1*m[e];break;case 41:this.$=1*(m[e-2]+"."+m[e]);break;case 42:this.$=.01*m[e-1];break;case 43:this.$=m[e-2]+m[e-1]+m[e];break;case 44:this.$=m[e-2]+m[e-1]+m[e]}},table:[{2:15,3:1,4:2,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1, 17],38:[1,21]},{1:[3]},{5:[1,22],11:[1,23],12:[1,24],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31]},{5:[2,2],11:[2,2],12:[2,2],14:[2,2],17:[2,2],18:[2,2],19:[2,2],20:[2,2],21:[2,2],22:[2,2],23:[2,2],24:[2,2],32:[2,2],33:[2,2],35:[1,32]},{5:[2,3],11:[2,3],12:[2,3],14:[2,3],17:[2,3],18:[2,3],19:[2,3],20:[2,3],21:[2,3],22:[2,3],23:[2,3],24:[2,3],32:[2,3],33:[2,3]},{5:[2,4],11:[2,4],12:[2,4],14:[2,4],17:[2,4],18:[2,4],19:[2,4],20:[2,4],21:[2,4],22:[2,4],23:[2,4],24:[2,4],32:[2, 4],33:[2,4]},{5:[2,5],11:[2,5],12:[2,5],14:[2,5],17:[2,5],18:[2,5],19:[2,5],20:[2,5],21:[2,5],22:[2,5],23:[2,5],24:[2,5],32:[2,5],33:[2,5],37:[1,33]},{5:[2,6],11:[2,6],12:[2,6],14:[2,6],17:[2,6],18:[2,6],19:[2,6],20:[2,6],21:[2,6],22:[2,6],23:[2,6],24:[2,6],32:[2,6],33:[2,6]},{2:15,4:34,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:36,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1, 8],15:[1,9],16:35,21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:37,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:38,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,23],11:[2,23],12:[2,23],14:[2,23],17:[2,23], 18:[2,23],19:[2,23],20:[2,23],21:[2,23],22:[2,23],23:[2,23],24:[2,23],32:[2,23],33:[2,23]},{13:[1,39]},{5:[2,26],11:[2,26],12:[2,26],14:[2,26],17:[2,26],18:[2,26],19:[2,26],20:[2,26],21:[2,26],22:[2,26],23:[2,26],24:[2,26],32:[2,26],33:[2,26]},{2:40,5:[2,27],11:[2,27],12:[2,27],14:[2,27],17:[2,27],18:[2,27],19:[2,27],20:[2,27],21:[2,27],22:[2,27],23:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[1,41],38:[1,21]},{5:[2,38],11:[2,38],12:[2,38],14:[2,38],17:[2,38],18:[2,38],19:[2,38],20:[2,38],21:[2,38],22:[2, 38],23:[2,38],24:[2,38],32:[2,38],33:[2,38],35:[2,38],38:[1,42]},{5:[2,40],11:[2,40],12:[2,40],14:[2,40],17:[2,40],18:[2,40],19:[2,40],20:[2,40],21:[2,40],22:[2,40],23:[2,40],24:[2,40],32:[2,40],33:[2,40],35:[1,43],37:[2,40]},{5:[2,29],11:[2,29],12:[2,29],14:[2,29],17:[2,29],18:[2,29],19:[2,29],20:[2,29],21:[2,29],22:[2,29],23:[2,29],24:[2,29],29:[1,44],32:[2,29],33:[2,29]},{5:[2,31],11:[2,31],12:[2,31],14:[2,31],17:[2,31],18:[2,31],19:[2,31],20:[2,31],21:[2,31],22:[2,31],23:[2,31],24:[2,31],29:[1, 45],32:[2,31],33:[2,31]},{19:[1,46]},{34:[1,47]},{1:[2,1]},{2:15,4:48,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:49,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:52,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],11:[1,50],12:[1,11],13:[1,8],15:[1,9],19:[1,51],21:[1,10],25:[1, 12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:54,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],11:[1,53],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:55,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:56,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9], 21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:57,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:58,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:59,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1, 9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{34:[1,60]},{5:[2,42],11:[2,42],12:[2,42],14:[2,42],17:[2,42],18:[2,42],19:[2,42],20:[2,42],21:[2,42],22:[2,42],23:[2,42],24:[2,42],32:[2,42],33:[2,42],37:[2,42]},{11:[1,23],12:[1,24],14:[1,61],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31]},{17:[1,62],32:[1,63],33:[1,64]},{11:[1,23],12:[1,24],14:[2,35],17:[2,35],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1, 31],32:[2,35],33:[2,35]},{5:[2,21],11:[2,21],12:[2,21],14:[2,21],17:[2,21],18:[2,21],19:[2,21],20:[2,21],21:[2,21],22:[1,29],23:[1,30],24:[1,31],32:[2,21],33:[2,21]},{5:[2,22],11:[2,22],12:[2,22],14:[2,22],17:[2,22],18:[2,22],19:[2,22],20:[2,22],21:[2,22],22:[1,29],23:[1,30],24:[1,31],32:[2,22],33:[2,22]},{2:15,4:36,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],14:[1,65],15:[1,9],16:66,21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,28], 11:[2,28],12:[2,28],14:[2,28],17:[2,28],18:[2,28],19:[2,28],20:[2,28],21:[2,28],22:[2,28],23:[2,28],24:[2,28],32:[2,28],33:[2,28]},{38:[1,42]},{34:[1,67]},{36:[1,68]},{28:[1,69]},{30:[1,70]},{30:[1,71]},{39:[1,72]},{5:[2,7],11:[2,7],12:[1,24],14:[2,7],17:[2,7],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,7],33:[2,7]},{5:[2,8],11:[2,8],12:[2,8],14:[2,8],17:[2,8],18:[2,8],19:[2,8],20:[2,8],21:[2,8],22:[1,29],23:[1,30],24:[1,31],32:[2,8],33:[2,8]},{2:15,4:73,6:3,7:[1,4], 8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:74,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,16],11:[2,16],12:[1,24],14:[2,16],17:[2,16],18:[2,16],19:[2,16],20:[2,16],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,16],33:[2,16]},{2:15,4:75,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1, 11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,15],11:[2,15],12:[1,24],14:[2,15],17:[2,15],18:[2,15],19:[2,15],20:[2,15],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,15],33:[2,15]},{5:[2,14],11:[2,14],12:[1,24],14:[2,14],17:[2,14],18:[1,25],19:[1,26],20:[2,14],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,14],33:[2,14]},{5:[2,17],11:[2,17],12:[2,17],14:[2,17],17:[2,17],18:[2,17],19:[2,17],20:[2,17],21:[2,17],22:[1,29], 23:[1,30],24:[1,31],32:[2,17],33:[2,17]},{5:[2,18],11:[2,18],12:[2,18],14:[2,18],17:[2,18],18:[2,18],19:[2,18],20:[2,18],21:[2,18],22:[2,18],23:[2,18],24:[1,31],32:[2,18],33:[2,18]},{5:[2,19],11:[2,19],12:[2,19],14:[2,19],17:[2,19],18:[2,19],19:[2,19],20:[2,19],21:[2,19],22:[2,19],23:[2,19],24:[1,31],32:[2,19],33:[2,19]},{5:[2,20],11:[2,20],12:[2,20],14:[2,20],17:[2,20],18:[2,20],19:[2,20],20:[2,20],21:[2,20],22:[2,20],23:[2,20],24:[2,20],32:[2,20],33:[2,20]},{5:[2,39],11:[2,39],12:[2,39],14:[2,39], 17:[2,39],18:[2,39],19:[2,39],20:[2,39],21:[2,39],22:[2,39],23:[2,39],24:[2,39],32:[2,39],33:[2,39],35:[2,39]},{5:[2,9],11:[2,9],12:[2,9],14:[2,9],17:[2,9],18:[2,9],19:[2,9],20:[2,9],21:[2,9],22:[2,9],23:[2,9],24:[2,9],32:[2,9],33:[2,9]},{5:[2,10],11:[2,10],12:[2,10],14:[2,10],17:[2,10],18:[2,10],19:[2,10],20:[2,10],21:[2,10],22:[2,10],23:[2,10],24:[2,10],32:[2,10],33:[2,10]},{2:15,4:76,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1, 19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:77,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,24],11:[2,24],12:[2,24],14:[2,24],17:[2,24],18:[2,24],19:[2,24],20:[2,24],21:[2,24],22:[2,24],23:[2,24],24:[2,24],32:[2,24],33:[2,24]},{14:[1,78],32:[1,63],33:[1,64]},{39:[1,79]},{5:[2,41],11:[2,41],12:[2,41],14:[2,41],17:[2,41],18:[2,41],19:[2,41],20:[2,41],21:[2,41],22:[2,41],23:[2, 41],24:[2,41],32:[2,41],33:[2,41],37:[2,41]},{5:[2,30],11:[2,30],12:[2,30],14:[2,30],17:[2,30],18:[2,30],19:[2,30],20:[2,30],21:[2,30],22:[2,30],23:[2,30],24:[2,30],32:[2,30],33:[2,30]},{5:[2,32],11:[2,32],12:[2,32],14:[2,32],17:[2,32],18:[2,32],19:[2,32],20:[2,32],21:[2,32],22:[2,32],23:[2,32],24:[2,32],32:[2,32],33:[2,32]},{5:[2,33],11:[2,33],12:[2,33],14:[2,33],17:[2,33],18:[2,33],19:[2,33],20:[2,33],21:[2,33],22:[2,33],23:[2,33],24:[2,33],29:[1,80],32:[2,33],33:[2,33]},{5:[2,43],11:[2,43],12:[2, 43],14:[2,43],17:[2,43],18:[2,43],19:[2,43],20:[2,43],21:[2,43],22:[2,43],23:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43]},{5:[2,11],11:[2,11],12:[1,24],14:[2,11],17:[2,11],18:[2,11],19:[2,11],20:[2,11],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,11],33:[2,11]},{5:[2,13],11:[2,13],12:[1,24],14:[2,13],17:[2,13],18:[2,13],19:[2,13],20:[2,13],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,13],33:[2,13]},{5:[2,12],11:[2,12],12:[1,24],14:[2,12],17:[2,12],18:[2,12],19:[2,12],20:[2,12],21:[1, 28],22:[1,29],23:[1,30],24:[1,31],32:[2,12],33:[2,12]},{11:[1,23],12:[1,24],14:[2,36],17:[2,36],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,36],33:[2,36]},{11:[1,23],12:[1,24],14:[2,37],17:[2,37],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,37],33:[2,37]},{5:[2,25],11:[2,25],12:[2,25],14:[2,25],17:[2,25],18:[2,25],19:[2,25],20:[2,25],21:[2,25],22:[2,25],23:[2,25],24:[2,25],32:[2,25],33:[2,25]},{5:[2,44],11:[2,44],12:[2,44],14:[2,44],17:[2, 44],18:[2,44],19:[2,44],20:[2,44],21:[2,44],22:[2,44],23:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],38:[2,44]},{30:[1,81]},{5:[2,34],11:[2,34],12:[2,34],14:[2,34],17:[2,34],18:[2,34],19:[2,34],20:[2,34],21:[2,34],22:[2,34],23:[2,34],24:[2,34],32:[2,34],33:[2,34]}],defaultActions:{22:[2,1]},parseError:function(e,f){if(f.recoverable)this.trace(e);else throw Error(e);},parse:function(e){function f(a){k.length-=2*a;m.length-=a;l.length-=a}function g(){var a;a=b.lexer.lex()||h;"number"!==typeof a&& (a=b.symbols_[a]||a);return a}var b=this,k=[0],m=[null],l=[],s=this.table,n="",a=0,c=0,d=0,h=1,p=l.slice.call(arguments,1);this.lexer.setInput(e);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var r=this.lexer.yylloc;l.push(r);var E=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"===typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var u,z,x,w,A={},B,y;;){x= k[k.length-1];if(this.defaultActions[x])w=this.defaultActions[x];else{if(null===u||"undefined"==typeof u)u=g();w=s[x]&&s[x][u]}if("undefined"===typeof w||!w.length||!w[0]){var q;w="";y=function(a){for(var c=k.length-1,d=0;;){if((2).toString()in s[a])return d;if(0===a||2>c)return!1;c-=2;a=k[c];++d}};if(d)z!==h&&(q=y(x));else{q=y(x);y=[];for(B in s[x])this.terminals_[B]&&2<B&&y.push("'"+this.terminals_[B]+"'");w=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+ y.join(", ")+", got '"+(this.terminals_[u]||u)+"'":"Parse error on line "+(a+1)+": Unexpected "+(u==h?"end of input":"'"+(this.terminals_[u]||u)+"'");this.parseError(w,{text:this.lexer.match,token:this.terminals_[u]||u,line:this.lexer.yylineno,loc:r,expected:y,recoverable:!1!==q})}if(3==d){if(u===h||z===h)throw Error(w||"Parsing halted while starting to recover from another error.");c=this.lexer.yyleng;n=this.lexer.yytext;a=this.lexer.yylineno;r=this.lexer.yylloc;u=g()}if(!1===q)throw Error(w||"Parsing halted. No suitable error recovery rule available."); f(q);z=2==u?null:u;u=2;x=k[k.length-1];w=s[x]&&s[x][2];d=3}if(w[0]instanceof Array&&1<w.length)throw Error("Parse Error: multiple actions possible at state: "+x+", token: "+u);switch(w[0]){case 1:k.push(u);m.push(this.lexer.yytext);l.push(this.lexer.yylloc);k.push(w[1]);u=null;z?(u=z,z=null):(c=this.lexer.yyleng,n=this.lexer.yytext,a=this.lexer.yylineno,r=this.lexer.yylloc,0<d&&d--);break;case 2:y=this.productions_[w[1]][1];A.$=m[m.length-y];A._$={first_line:l[l.length-(y||1)].first_line,last_line:l[l.length- 1].last_line,first_column:l[l.length-(y||1)].first_column,last_column:l[l.length-1].last_column};E&&(A._$.range=[l[l.length-(y||1)].range[0],l[l.length-1].range[1]]);x=this.performAction.apply(A,[n,c,a,this.yy,w[1],m,l].concat(p));if("undefined"!==typeof x)return x;y&&(k=k.slice(0,-2*y),m=m.slice(0,-1*y),l=l.slice(0,-1*y));k.push(this.productions_[w[1]][0]);m.push(A.$);l.push(A._$);x=s[k[k.length-2]][k[k.length-1]];k.push(x);break;case 3:return!0}}return!0}},g=function(){return{EOF:1,parseError:function(e, f){if(this.yy.parser)this.yy.parser.parseError(e,f);else throw Error(e);},setInput:function(e){this._input=e;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e; e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return e},unput:function(e){var f=e.length,g=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-f-1);this.offset-=f;e=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);g.length-1&&(this.yylineno-= g.length-1);var b=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:g?(g.length===e.length?this.yylloc.first_column:0)+e[e.length-g.length].length-g[0].length:this.yylloc.first_column-f};this.options.ranges&&(this.yylloc.range=[b[0],b[0]+this.yyleng-f]);this.yyleng=this.yytext.length;return this},more:function(){this._more=!0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0; else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e= this.match;20>e.length&&(e+=this._input.substr(0,20-e.length));return(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),f=Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+f+"^"},test_match:function(e,f){var g,b;this.options.backtrack_lexer&&(b={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match, matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(b.yylloc.range=this.yylloc.range.slice(0)));if(g=e[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=g.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:g?g[g.length-1].length-g[g.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._backtrack=this._more=!1;this._input=this._input.slice(e[0].length);this.matched+=e[0];g=this.performAction.call(this,this.yy,this,f,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(g)return g;if(this._backtrack)for(var k in b)this[k]=b[k];return!1},next:function(){if(this.done)return this.EOF; this._input||(this.done=!0);var e,f,g;this._more||(this.match=this.yytext="");for(var b=this._currentRules(),k=0;k<b.length;k++)if((f=this._input.match(this.rules[b[k]]))&&(!e||f[0].length>e[0].length))if(e=f,g=k,this.options.backtrack_lexer){e=this.test_match(f,b[k]);if(!1!==e)return e;if(this._backtrack)e=!1;else return!1}else if(!this.options.flex)break;return e?(e=this.test_match(e,b[g]),!1!==e?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+ this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){e= this.conditionStack.length-1-Math.abs(e||0);return 0<=e?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,g,k,b){switch(k){case 1:return 10;case 2:return 10;case 3:return 31;case 4:return 26;case 5:return 7;case 6:return 8;case 7:return"cell"==f.obj.type?31:34;case 8:return"cell"==f.obj.type?28:34;case 9:return"cell"==f.obj.type?30:34;case 10:return 26;case 11:return 34;case 12:return 34; case 13:return 36;case 15:return" ";case 16:return 35;case 17:return 29;case 18:return 32;case 19:return 33;case 20:return 22;case 21:return 23;case 22:return 21;case 23:return 12;case 24:return 24;case 25:return 13;case 26:return 14;case 27:return 15;case 28:return 17;case 29:return 19;case 30:return 18;case 31:return 20;case 32:return"PI";case 33:return 25;case 34:return'"';case 35:return"'";case 36:return"!";case 37:return 11;case 38:return 37;case 39:return 38;case 40:return 5}},rules:[/^(?:\s+)/, /^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:#[A-Za-z0-9_]+)/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:[A-Za-z0-9_]+>[A-Za-z0-9_]+)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/, /^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],inclusive:!0}}}}();l.lexer=g;k.prototype=l;l.Parser=k;return new k}function q(f,k){this.sheet=f;this.el="undefined"!=typeof k?s(k):!1;this.floatValue=this.computedValue=this.formattedValue= this.value=null;this.affected=!1;this.dependencies={};this.dependant={};this.conditionalStyle={};this.init()}function n(f,k,l){this.identifier=f;this.el=s(k);this.lang="en";this.cells={};this.variables={};this.config=s.extend({},F,l);this.counter=1;this.init()}"function"!==typeof Array.indexOf&&(Array.prototype.indexOf=function(f,k){for(var l=k||0;l<this.length;l++)if(this[l]==f)return l;return-1});"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g, "")});"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(f){return f.__proto__}:function(f){return f.constructor.prototype});var F={autoCalculate:!0,autoCalculateTrigger:"blur",onBeforeCalculate:function(f){return f},onAfterCalculate:function(f){return f},onBeforeApply:function(f){return f},onAfterApply:function(f){return f},zeroFormat:null,precision:2,defaultFormat:"0[.]00",ajaxUrl:null};q.prototype.init=function(){var f=this.el?this.el.attr("data-cell"): "",k=this.el?this.el.attr("data-formula"):"",l=this.el?this.el.attr("data-format"):"",g=this.el?this.el.val():null;f&&""!=s.trim(f)?f=f.toUpperCase():(f="CALX"+this.sheet.counter,this.el&&this.el.attr("data-cell",f),this.sheet.counter++);k=k&&""!=s.trim(k)?k.replace("&quot;",'"').replace("&#39;","'").replace("&#34;",'"'):!1;l&&""!=s.trim(l)||(l=!1);this.value=g;this.formula=k;this.format=l;this.address=f;this.setValue(g);this.attachEvent()};q.prototype.buildDependency=function(){var f={remoteCellRange:/\#[A-Za-z0-9_]+\s*>\s*[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g, remoteCell:/\#[A-Za-z0-9_]+\s*>\s*[A-Za-z]+[0-9]+/g,cellRange:/[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g,cell:/[A-Z]+[0-9]+/g},k=this.formula,l="#"+this.sheet.el.attr("id"),g=this.getAddress(),e,v,n,b,q,m;for(v in this.dependencies)-1===v.indexOf("#")?this.dependencies[v].removeDependant(g):this.dependencies[v].removeDependant(l+">"+g),delete this.dependencies[v];if(k)for(v in f)if(q=k.match(f[v]),k=k.replace(f[v],""),null!==q)switch(v){case "remoteCellRange":for(g=0;g<q.length;g++)for(n in e=q[g].split(">"), m=s.trim(e[0]),b=e[1].split(":"),e=s.trim(b[0]),b=s.trim(b[1]),e=this.sheet.getRemoteCellRange(m,e,b),e)b=m+">"+n,"undefined"==typeof this.dependencies[b]&&!1!==e[n]&&(this.dependencies[b]=e[n],e[n].registerDependant(l+">"+this.getAddress(),this));break;case "remoteCell":for(g=0;g<q.length;g++)e=q[g].split(">"),m=s.trim(e[0]),b=s.trim(e[1]),e=this.sheet.getRemoteCell(m,b),b=m+">"+b,"undefined"==typeof this.dependencies[b]&&!1!==e&&(this.dependencies[b]=e,e.registerDependant(l+">"+this.getAddress(), this));break;case "cellRange":for(g=0;g<q.length;g++)for(n in b=q[g].split(":"),e=s.trim(b[0]),b=s.trim(b[1]),e=this.sheet.getCellRange(e,b),e)"undefined"==typeof this.dependencies[n]&&!1!==e[n]&&(this.dependencies[n]=e[n],e[n].registerDependant(this.getAddress(),this));break;case "cell":for(g=0;g<q.length;g++)b=q[g],e=this.sheet.getCell(b),"undefined"==typeof this.dependencies[b]&&!1!==e&&(this.dependencies[b]=e,e.registerDependant(this.getAddress(),this))}};q.prototype.buildDependency=function(){var f= {remoteCellRange:/\#[A-Za-z0-9_]+\s*>\s*[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g,remoteCell:/\#[A-Za-z0-9_]+\s*>\s*[A-Za-z]+[0-9]+/g,cellRange:/[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g,cell:/[A-Z]+[0-9]+/g},k=this.formula,l="#"+this.sheet.el.attr("id"),g=this.getAddress(),e,v,n,b,q,m;for(v in this.dependencies)-1===v.indexOf("#")?this.dependencies[v].removeDependant(g):this.dependencies[v].removeDependant(l+">"+g),delete this.dependencies[v];if(k)for(v in f)if(q=k.match(f[v]),k=k.replace(f[v],""),null!== q)switch(v){case "remoteCellRange":for(g=0;g<q.length;g++)for(n in e=q[g].split(">"),m=s.trim(e[0]),b=e[1].split(":"),e=s.trim(b[0]),b=s.trim(b[1]),e=this.sheet.getRemoteCellRange(m,e,b),e)b=m+">"+n,"undefined"==typeof this.dependencies[b]&&!1!==e[n]&&(this.dependencies[b]=e[n],e[n].registerDependant(l+">"+this.getAddress(),this));break;case "remoteCell":for(g=0;g<q.length;g++)e=q[g].split(">"),m=s.trim(e[0]),b=s.trim(e[1]),e=this.sheet.getRemoteCell(m,b),b=m+">"+b,"undefined"==typeof this.dependencies[b]&& !1!==e&&(this.dependencies[b]=e,e.registerDependant(l+">"+this.getAddress(),this));break;case "cellRange":for(g=0;g<q.length;g++)for(n in b=q[g].split(":"),e=s.trim(b[0]),b=s.trim(b[1]),e=this.sheet.getCellRange(e,b),e)"undefined"==typeof this.dependencies[n]&&!1!==e[n]&&(this.dependencies[n]=e[n],e[n].registerDependant(this.getAddress(),this));break;case "cell":for(g=0;g<q.length;g++)b=q[g],e=this.sheet.getCell(b),"undefined"==typeof this.dependencies[b]&&!1!==e&&(this.dependencies[b]=e,e.registerDependant(this.getAddress(), this))}};q.prototype.registerDependant=function(f,k){"undefined"==typeof this.dependant[f]&&k&&(this.dependant[f]=k)};q.prototype.removeDependant=function(f){"undefined"!=typeof this.dependant[f]&&delete this.dependant[f]};q.prototype.checkCircularReference=function(f){var k,l=!1;"undefined"==typeof f&&(f=this.getAddress());if(!1!==this.formula){for(k in this.dependencies)if(l=l||k==f)return!0;for(k in this.dependencies)if(l=l||this.dependencies[k].checkCircularReference(f))return!0}return l};q.prototype.evaluateFormula= function(){this.formula&&(this.computedValue=this.sheet.evaluate(this.formula))};q.prototype.attachEvent=function(){var f=this.el.prop("tagName").toLowerCase(),k=this;-1<this.formTags.indexOf(f)&&(this.el.on("calxChange",function(){this.setValue(this.el.val())}),"input"==f?(this.el.on("claxFocus",function(){this.el.val(k.getValue())}),this.el.on("calxBlur",function(){k.setValue(k.el.val())}),this.el.on("calxKeyDown",function(){}),this.el.on("calxKeyUp",function(){}),this.el.blur(function(){s(this).trigger("calxBlur")}), this.el.focus(function(){s(this).trigger("calxFocus")})):"select"==f&&this.el.change(function(){s(this).trigger("calxChange")}))};q.prototype.formTags=["input","select","textarea","button"];q.prototype.setFormat=function(f){this.format=f;!1!==this.el&&this.el.attr("data-format",f)};q.prototype.getFormat=function(){return this.format};q.prototype.setFormula=function(f){this.formula=f;!1!==this.el&&this.el.attr("data-formula",f);this.buildDependency()};q.prototype.getFormula=function(){return this.formula}; q.prototype.getAddress=function(){return this.address};q.prototype.setValue=function(f){this.value=f;this.floatValue=s.isNumeric(f)?parseFloat(f):0;this.formattedValue=this.sheet.engine.formatter(this.floatValue,this.format?this.format:this.sheet.config.defaultFormat);!1!==this.el&&(f=this.el.prop("tagName").toLowerCase(),-1<this.formTags.indexOf(f)?this.el.val(this.value):this.el.html(this.value))};q.prototype.getValue=function(){return this.value};q.prototype.getStringValue=function(){return this.value+ ""};q.prototype.getFormattedValue=function(){return this.formattedValue};q.prototype.getFloatValue=function(){return this.floatValue};q.prototype.setAffected=function(f){this.affected=f};q.prototype.isAffected=function(){return this.affected};n.prototype.init=function(){var f=this.el.find("[data-cell],[data-formula],[data-format]"),k=this,l;this.parser=C(this);this.el.attr("data-calx-identifier",this.identifier);f.each(function(){l=new q(k,this);k.registerCell(l)})};n.prototype.checkCircularReference= function(){var f,k={isCircular:!1,cell:null};for(f in this.cells)if(k.isCircular=this.cells[f].checkCircularReference(),!0===k.isCircular){k.cell=this.cells[f];break}return k};n.prototype.buildCellDependency=function(){for(var f in this.cells)this.cells[f].buildDependency()};n.prototype.getCellValue=function(f){f=f.toUpperCase();return"undefined"==typeof this.cells[f]?!1:this.cells[f].value};n.prototype.getCellRangeValue=function(f,k){var l=this.engine.utility.cellRange(f,k),g=l.length,e={},n;for(n= 0;n<g;n++)e[l[n]]=this.getCellValue(l[n]);return e};n.prototype.getRemoteCellRangeValue=function(f,k,l){return(f=s(f).attr("data-calx-identifier"))&&"undefined"!=typeof t.sheetRegistry[f]?t.sheetRegistry[f].getCellRangeValue(k,l):!1};n.prototype.getRemoteCellValue=function(f,k){var l=s(f).attr("data-calx-identifier");return l&&"undefined"!=typeof t.sheetRegistry[l]?t.sheetRegistry[l].getCellValue(k):!1};n.prototype.getRemoteCellRange=function(f,k,l){return(f=s(f).attr("data-calx-identifier"))&&"undefined"!= typeof t.sheetRegistry[f]?t.sheetRegistry[f].getCellRange(k,l):!1};n.prototype.getRemoteCell=function(f,k){var l=s(f).attr("data-calx-identifier");return l&&"undefined"!=typeof t.sheetRegistry[l]?t.sheetRegistry[l].getCell(k):!1};n.prototype.callFunction=function(f,k){var l,g;g=f.toUpperCase();if("function"==typeof this.engine.formula[g])return this.engine.formula[g].apply(this,k);for(l in this.engine.formula)if("function"==typeof this.engine.formula[l][g])return this.engine.formula[l][g].apply(this, k);return"#UNDEFINED_FORMULA"};n.prototype.time=function(f){var k=f.split(":");f=new Date;var l="undefined"==typeof k[0]?0:k[0],g="undefined"==typeof k[1]?0:k[1],k="undefined"==typeof k[2]?0:k[2];return new Date(f.getFullYear(),f.getMonth(),f.getDate(),l,g,k)};n.prototype.getVariable=function(f){f=f[0];return"undefined"==typeof this.variables[f]?"#UNDEFINED_VARIABLE":this.variables[f]};n.prototype.comparator={greater:function(f,k){return f>k}};n.prototype.obj={type:"cell"};n.prototype.evaluate=function(f){return this.parser.parse(f)}; n.prototype.update=function(){};n.prototype.calculate=function(){};n.prototype.registerCell=function(f){this.cells[f.getAddress()]=f};n.prototype.getCell=function(f){return"undefined"!=typeof this.cells[f]?this.cells[f]:!1};n.prototype.getCellRange=function(f,k){var l=this.engine.utility.cellRange(f,k),g=l.length,e={},n;for(n=0;n<g;n++)e[l[n]]=this.getCell(l[n]);return e};n.prototype.apply=function(){};n.prototype.scan=function(){};n.prototype.refresh=function(){};n.prototype.engine={formatter:function(f, k){return numeral?numeral(f).format(k):f},bignumber:function(f){},formula:{math:{},financial:{},statistic:{},logical:{IF:function(f,k,l){return f?k:l}},geometry:{},text:{CONCAT:function(){var f="",k;for(k in arguments)f="object"==typeof arguments[k]?f+this.engine.formula.text.CONCAT.apply(this,arguments[k]):f+(arguments[k]+"");return f}},trigonometry:{},general:{SUM:function(){var f=0,k;for(k in arguments)f="object"==typeof arguments[k]&&"cell"!==arguments[k].constructor.name?f+this.engine.formula.general.SUM.apply(this, arguments[k]):f+arguments[k].getFloatValue();return f},VLOOKUP:function(f,k,l){},HLOOKUP:function(f,k,l){}},zstoic:function(f,k,l,g,e,n,q){var b={},s=q.MD5,m=[],t=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],C=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],D=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0, void 0,[0],[1],[2],[3],[4],[5],[6]];b.UNIQUE=function(){return e.unique(arguments)};b.FLATTEN=function(){return e.flatten(arguments)};b.FUNCTION=function(){var a=Array.prototype.slice.call(arguments),c=a[a.length-1],d=c.replace(/(\w+)\(/g,function(a){return"Formulae."+a});a[a.length-1]="return "+d+";";d!==c&&a.unshift("Formulae");return Function.apply(null,a)};b.MOMENT=function(a,c){return g(a).format(c)};b.MOMENTADD=function(a,c,d){return g(a).add(c,d)};b.MOMENTDIFF=function(a,c,d){return g(c).diff(g.utc(a), d)};b.MOMENTSUB=function(a,c,d){return g(a).subtract(c,d)};b.MOMENTUTC=function(a,c){return g.utc(a).format(c)};b.MOMENTUTCADD=function(a,c,d){return g.utc(a).add(c,d)};b.MOMENTUTCDIFF=function(a,c,d){return g.utc(c).diff(g.utc(a),d)};b.MOMENTUTCSUB=function(a,c,d){return g.utc(a).subtract(c,d)};b.MOMENTUNIX=function(a){return g.unix(a).toDate()};b.MOMENTFORMAT=function(a,c){return g(a).format(c)};b.MOMENTISLEAPYEAR=function(a,c){return g(a,c).isLeapYear()};b.MOMENTISDST=function(a,c){return g(a, c).isDST()};b.MOMENTSTARTOF=function(a,c,d){return g(a,d).startOf(c).toDate()};b.MOMENTENDOF=function(a,c,d){return g(a,d).endOf(c).toDate()};b.MOMENTISAFTER=function(a,c,d){return g(a,d).isAfter(g(c,d))};b.MOMENTISBEFORE=function(a,c,d){return g(a,d).isBefore(g(c,d))};b.INTERVAL=function(a){var c=Math.floor(a/94608E4);a%=94608E4;var d=Math.floor(a/2592E3);a%=2592E3;var b=Math.floor(a/86400);a%=86400;var p=Math.floor(a/3600);a%=3600;var r=Math.floor(a/60);a%=60;return"P"+(0<c?c+"Y":"")+(0<d?d+"M": "")+(0<b?b+"D":"")+"T"+(0<p?p+"H":"")+(0<r?r+"M":"")+(0<a?a+"S":"")};b.ARGSCONCAT=function(a){for(var c=[],d=0;d<a.length;d++)c=c.concat(a[d]);return c};b.ARGSTOARRAY=function(a){return Array.prototype.slice.call(a,0)};b.CLEANFLOAT=function(a){var c=Math.pow(10,14);return Math.round(a*c)/c};b.COUNTIN=function(a,c){for(var d=0,b=0;b<a.length;b++)a[b]===c&&d++;return d};b.GETJSON=function(a){var c=new XMLHttpRequest;c.open("GET",a,!1);c.send(null);if(200===c.status)return JSON.parse(c.responseText)}; b.DATE=function(a,c,d){return new Date(a,c-1,d)};b.DATEVALUE=function(a){return Math.ceil((g(a)-g("1900-1-1"))/864E5)+2};b.DAY=function(a){return g(new Date(a)).date()};b.DAYS=function(a,c){return g(new Date(a)).diff(g(new Date(c)),"days")};b.DAYS360=function(a,c,d){a=g(new Date(a));c=g(new Date(c));var b=31,p=31,r=a.date(),e=c.date();if(d)r=31===r?30:r,e=31===e?30:e;else if(1===a.month()&&(b=a.daysInMonth()),1===c.month()&&(p=c.daysInMonth()),r=r===b?30:r,30===r||r===b)e=e===p?30:e;return 360*(c.year()- a.year())+30*(c.month()-a.month())+(e-r)};b.EDATE=function(a,c){return g(new Date(a)).add("months",c).toDate()};b.EOMONTH=function(a,c){var d=g(new Date(a)).add("months",c);return new Date(d.year(),d.month(),d.daysInMonth())};b.FROMNOW=function(a,c){return g(new Date(a)).fromNow(c)};b.HOUR=function(a){return 1>=a?Math.floor(24*a):g(new Date(a)).hours()};b.MINUTE=function(a){return 1>=a?Math.floor(1440*a)-60*Math.floor(24*a):g(new Date(a)).minutes()};b.ISOWEEKNUM=function(a){return g(new Date(a)).format("w")}; b.MONTH=function(a){return g(new Date(a)).month()+1};b.NETWORKDAYS=function(a,c,d){return b.NETWORKDAYSINTL(a,c,1,d)};b.NETWORKDAYSINTL=function(a,c,d,b){d=D["undefined"===typeof d?1:d];var p=g(a);a=c=g(c).diff(p,"days")+1;var r="",e=[];if("undefined"!==typeof b)for(r=0;r<b.length;r++)e[r]=g(new Date(b[r])).format("MM-DD-YYYY");for(b=0;b<c;)r=p.format("d"),0<=d.indexOf(parseInt(r,10))?a--:0<=e.indexOf(p.format("MM-DD-YYYY"))&&a--,p=p.add("days",1),b++;return a};b.NOW=function(){return new Date};b.SECOND= function(a){return g(new Date(a)).seconds()};b.TIME=function(a,c,d){return(3600*a+60*c+d)/86400};b.TIMEVALUE=function(a){a=g(new Date(a));return(3600*a.hours()+60*a.minutes()+a.seconds())/86400};b.TODAY=function(){return new Date};b.WEEKDAY=function(a,c){var d=g(new Date(a)).format("d");return C["undefined"===typeof c?1:c][d]};b.WEEKNUM=function(a,c){var d=g(new Date(a)),h=g(new Date(d.year(),0,1)),p="undefined"===typeof c?1:c,r=t[p],e=h.format("d"),r=e<r?r-e+1:e-r;return 21===p?b.ISOWEEKNUM(a):Math.floor(d.diff(h.subtract("days", r),"days")/7)+1};b.WORKDAY=function(a,c,d){return b.WORKDAYINTL(a,c,1,d)};b.WORKDAYINTL=function(a,c,d,b){d=D["undefined"===typeof d?1:d];a=g(new Date(a));var p="",r=[];if("undefined"!==typeof b)for(p=0;p<b.length;p++)r[p]=g(new Date(b[p])).format("MM-DD-YYYY");for(b=0;b<c;)a=a.add("days",1),p=a.format("d"),0>d.indexOf(parseInt(p,10))&&0>r.indexOf(a.format("MM-DD-YYYY"))&&b++;return a.toDate()};b.YEAR=function(a){return g(new Date(a)).year()};b.YEARFRAC=function(a,c,d){d="undefined"===typeof d?0: d;var b=g(new Date(a)),p=g(new Date(c));if(!b.isValid()||!p.isValid())return"#VALUE!";if(-1===[0,1,2,3,4].indexOf(d))return"#NUM!";if(b===p)return 0;0<b.diff(p)&&(p=g(new Date(a)),b=g(new Date(c)));var r=b.year(),e=b.month(),f=b.date(),k=p.year();a=p.month();c=p.date();switch(d){case 0:return 31===f&&31===c?c=f=30:31===f?f=30:30===f&&31===c?c=30:1===e&&1===a&&b.daysInMonth()===f&&p.daysInMonth()===c?c=f=30:1===e&&b.daysInMonth()===f&&(f=30),(c+30*a+360*k-(f+30*e+360*r))/360;case 1:d=365;if(r===k|| r+1===k&&(e>a||e===a&&f>=c)){if(r===k&&g([r]).isLeapYear())d=366;else if(r=b,k=p,e=g(new Date(r.year(),2,1)),g([r.year()]).isLeapYear()&&0>r.diff(e)&&0<=k.diff(e)?r=!0:(e=g(new Date(k.year(),2,1)),r=g([k.year()]).isLeapYear()&&0<=k.diff(e)&&0>r.diff(e)?!0:!1),r||1===a&&29===c)d=366;return p.diff(b,"days")/d}a=k-r+1;a=g(new Date(k+1,0,1)).diff(g(new Date(r,0,1)),"days")/a;return p.diff(b,"days")/a;case 2:return p.diff(b,"days")/360;case 3:return p.diff(b,"days")/365;case 4:return 31===f&&(f=30),31=== c&&(c=30),(c+30*a+360*k-(f+30*e+360*r))/360}};b.BESSELI=function(){};b.BESSELJ=function(){};b.BESSELK=function(){};b.BESSELY=function(){};b.VALIDBIN=function(a){return/^[01]{1,10}$/.test(a)};b.BIN2DEC=function(a){if(!b.VALIDBIN(a))return"#NUM!";var c=parseInt(a,2);a=a.toString();return 10===a.length&&"1"===a.substring(0,1)?parseInt(a.substring(1),2)-512:c};b.BIN2HEX=function(a,c){if(!b.VALIDBIN(a))return"#NUM!";var d=a.toString();if(10===d.length&&"1"===d.substring(0,1))return(0xfffffffe00+parseInt(d.substring(1), 2)).toString(16);d=parseInt(a,2).toString(16);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.BIN2OCT=function(a,c){if(!b.VALIDBIN(a))return"#NUM!";var d=a.toString();if(10===d.length&&"1"===d.substring(0,1))return(1073741312+parseInt(d.substring(1),2)).toString(8);d=parseInt(a,2).toString(8);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c); return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.BITAND=function(a,c){return isNaN(a)||isNaN(c)?"#VALUE!":0>a||0>c||Math.floor(a)!==a||Math.floor(c)!==c||0xffffffffffff<a||0xffffffffffff<c?"#NUM!":a&c};b.BITLSHIFT=function(a,c){return isNaN(a)||isNaN(c)?"#VALUE!":0>a||Math.floor(a)!==a||0xffffffffffff<a||53<Math.abs(c)?"#NUM!":0<=c?a<<c:a>>-c};b.BITOR=function(a,c){return isNaN(a)||isNaN(c)?"#VALUE!":0>a||0>c||Math.floor(a)!==a||Math.floor(c)!==c||0xffffffffffff<a||0xffffffffffff<c?"#NUM!": a|c};b.BITRSHIFT=function(a,c){return isNaN(a)||isNaN(c)?"#VALUE!":0>a||Math.floor(a)!==a||0xffffffffffff<a||53<Math.abs(c)?"#NUM!":0<=c?a>>c:a<<-c};b.BITXOR=function(a,c){return isNaN(a)||isNaN(c)?"#VALUE!":0>a||0>c||Math.floor(a)!==a||Math.floor(c)!==c||0xffffffffffff<a||0xffffffffffff<c?"#NUM!":a^c};b.COMPLEX=function(a,c,d){if(isNaN(a)||isNaN(c))return"#VALUE!";d="undefined"===typeof d?"i":d;return"i"!==d&&"j"!==d?"#VALUE!":0===a&&0===c?0:0===a?1===c?d:c.toString()+d:0===c?a.toString():a.toString()+ (0<c?"+":"")+(1===c?d:c.toString()+d)};b.CONVERT=function(a,c,d){if(isNaN(a))return"#VALUE!";for(var b=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516E-17],["admiralty knot", "admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"], "energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715E-47],["cubic metre", "m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree","\u00b0",null,"angle",!1,!1,.0174532925199433], ["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon", "gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"], "energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule", "J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368], ["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4], ["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force", !0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],["pica (1/72 inch)","Pica",["Picapt"],"length", !1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance", !0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904], ["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon","tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null, "magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null, "area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],p={Yi:["yobi",80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi", 30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},r={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]}, e=null,f=null,g=c,k=d,l=1,m=1,n,q=0;q<b.length;q++){n=null===b[q][2]?[]:b[q][2];if(b[q][1]===g||0<=n.indexOf(g))e=b[q];if(b[q][1]===k||0<=n.indexOf(k))f=b[q]}if(null===e)for(n=p[c.substring(0,2)],q=r[c.substring(0,1)],"da"===c.substring(0,2)&&(q=["dekao",10,"da"]),n?(l=n[2],g=c.substring(2)):q&&(l=q[1],g=c.substring(q[2].length)),c=0;c<b.length;c++)if(n=null===b[c][2]?[]:b[c][2],b[c][1]===g||0<=n.indexOf(g))e=b[c];if(null===f)for(p=p[d.substring(0,2)],r=r[d.substring(0,1)],"da"===d.substring(0,2)&& (r=["dekao",10,"da"]),p?(m=p[2],k=d.substring(2)):r&&(m=r[1],k=d.substring(r[2].length)),d=0;d<b.length;d++)if(n=null===b[d][2]?[]:b[d][2],b[d][1]===k||0<=n.indexOf(k))f=b[d];return null===e||null===f||e[3]!==f[3]?"#N/A":a*e[6]*l/(f[6]*m)};b.DEC2BIN=function(a,c){if(isNaN(a))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(a)||-512>a||511<a)return"#NUM!";if(0>a)return"1"+n.repeat("0",9-(512+a).toString(2).length)+(512+a).toString(2);var d=parseInt(a,10).toString(2);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!"; if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.DEC2HEX=function(a,c){if(isNaN(a))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(a)||-549755813888>a||549755813887<a)return"#NUM!";if(0>a)return(1099511627776+a).toString(16);var d=parseInt(a,10).toString(16);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.DEC2OCT=function(a,c){if(isNaN(a))return"#VALUE!"; if(!/^-?[0-9]{1,9}$/.test(a)||-536870912>a||536870911<a)return"#NUM!";if(0>a)return(1073741824+a).toString(8);var d=parseInt(a,10).toString(8);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.DELTA=function(a,c){c="undefined"===typeof c?0:c;return isNaN(a)||isNaN(c)?"#VALUE!":a===c?1:0};b.ERF=function(a,c){c="undefined"===typeof c?0:c;return isNaN(a)||isNaN(c)?"#VALUE!":jStat.erf(a)};b.ERFC= function(a){return isNaN(a)?"#VALUE!":jStat.erfc(a)};b.ERFCPRECISE=function(){};b.ERFPRECISE=function(){};b.GESTEP=function(a,c){c="undefined"===typeof c?0:c;return isNaN(a)||isNaN(c)?"#VALUE!":a>=c?1:0};b.HEX2BIN=function(a,c){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return"#NUM!";var d=10===a.length&&"f"===a.substring(0,1).toLowerCase()?!0:!1,b=d?parseInt(a,16)-1099511627776:parseInt(a,16);if(-512>b||511<b)return"#NUM!";if(d)return"1"+n.repeat("0",9-(512+b).toString(2).length)+(512+b).toString(2);d=b.toString(2); if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.HEX2DEC=function(a){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return"#NUM!";a=parseInt(a,16);return 549755813888<=a?a-1099511627776:a};b.HEX2OCT=function(a,c){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return"#NUM!";var d=parseInt(a,16);if(536870911<d&&0xffe0000000>d)return"#NUM!";if(0xffe0000000<=d)return(d-0xffc0000000).toString(8);d=d.toString(8);if("undefined"=== typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.IMABS=function(a){var c=b.IMREAL(a);a=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"===a?"#NUM!":Math.sqrt(Math.pow(c,2)+Math.pow(a,2))};b.IMAGINARY=function(a){if(0===a||"0"===a)return 0;if(0<=["i","j"].indexOf(a))return 1;a=a.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var c=a.indexOf("+"),d=a.indexOf("-");0===c&&(c=a.indexOf("+", 1));0===d&&(d=a.indexOf("-",1));var b=a.substring(a.length-1,a.length),b="i"===b||"j"===b;return 0<=c||0<=d?b?0<=c?isNaN(a.substring(0,c))||isNaN(a.substring(c+1,a.length-1))?"#NUM!":Number(a.substring(c+1,a.length-1)):isNaN(a.substring(0,d))||isNaN(a.substring(d+1,a.length-1))?"#NUM!":-Number(a.substring(d+1,a.length-1)):"#NUM!":b?isNaN(a.substring(0,a.length-1))?"#NUM!":a.substring(0,a.length-1):isNaN(a)?"#NUM!":0};b.IMARGUMENT=function(a){var c=b.IMREAL(a);a=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"=== a?"#NUM!":0===c&&0===a?"#DIV/0!":0===c&&0<a?Math.PI/2:0===c&&0>a?-Math.PI/2:0===a&&0<c?0:0===a&&0>c?-Math.PI:0<c?Math.atan(a/c):0>c&&0<=a?Math.atan(a/c)+Math.PI:Math.atan(a/c)-Math.PI};b.IMCONJUGATE=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a),h=a.substring(a.length-1);return"#NUM!"===c||"#NUM!"===d?"#NUM!":0!==d?b.COMPLEX(c,-d,"i"===h||"j"===h?h:"i"):a};b.IMCOS=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"=== c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.cos(c)*(Math.exp(d)+Math.exp(-d))/2,-Math.sin(c)*(Math.exp(d)-Math.exp(-d))/2,a)};b.IMCOSH=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.cos(d)*(Math.exp(c)+Math.exp(-c))/2,Math.sin(d)*(Math.exp(c)-Math.exp(-c))/2,a)};b.IMCOT=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);return"#NUM!"=== c||"#NUM!"===d?"#NUM!":b.IMDIV(b.IMCOS(a),b.IMSIN(a))};b.IMCSC=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.IMDIV("1",b.IMSIN(a))};b.IMCSCH=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.IMDIV("1",b.IMSINH(a))};b.IMDIV=function(a,c){var d=b.IMREAL(a),h=b.IMAGINARY(a),p=b.IMREAL(c),r=b.IMAGINARY(c),e=a.substring(a.length-1),f=a.substring(a.length-1), g="i";"j"===e?g="j":"j"===f&&(g="j");if("#NUM!"===d||"#NUM!"===h||"#NUM!"===p||"#NUM!"===r||0===p&&0===r)return"#NUM!";e=p*p+r*r;return b.COMPLEX((d*p+h*r)/e,(h*p-d*r)/e,g)};b.IMEXP=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";if("#NUM!"===c||"#NUM!"===d)return"#NUM!";c=Math.exp(c);return b.COMPLEX(c*Math.cos(d),c*Math.sin(d),a)};b.IMLN=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"=== c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.log(Math.sqrt(c*c+d*d)),Math.atan(d/c),a)};b.IMLOG10=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.log(Math.sqrt(c*c+d*d))/Math.log(10),Math.atan(d/c)/Math.log(10),a)};b.IMLOG2=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.log(Math.sqrt(c*c+d*d))/Math.log(2), Math.atan(d/c)/Math.log(2),a)};b.IMPOWER=function(a,c){if(isNaN(c))return"#VALUE!";var d=b.IMREAL(a),h=b.IMAGINARY(a),p=a.substring(a.length-1),p="i"===p||"j"===p?p:"i";if("#NUM!"===d||"#NUM!"===h)return"#NUM!";d=Math.pow(b.IMABS(a),c);h=b.IMARGUMENT(a);return b.COMPLEX(d*Math.cos(c*h),d*Math.sin(c*h),p)};b.IMPRODUCT=function(){for(var a=arguments[0],c=1;c<arguments.length;c++){var d=b.IMREAL(a),a=b.IMAGINARY(a),h=b.IMREAL(arguments[c]),p=b.IMAGINARY(arguments[c]);if("#NUM!"===d||"#NUM!"===a||"#NUM!"=== h||"#NUM!"===p)return"#NUM!";a=b.COMPLEX(d*h-a*p,d*p+a*h)}return a};b.IMREAL=function(a){if(0===a||"0"===a||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(a))return 0;var c=a.indexOf("+"),d=a.indexOf("-");0===c&&(c=a.indexOf("+",1));0===d&&(d=a.indexOf("-",1));var b=a.substring(a.length-1,a.length),b="i"===b||"j"===b;return 0<=c||0<=d?b?0<=c?isNaN(a.substring(0,c))||isNaN(a.substring(c+1,a.length-1))?"#NUM!":Number(a.substring(0,c)):isNaN(a.substring(0,d))||isNaN(a.substring(d+1,a.length- 1))?"#NUM!":Number(a.substring(0,d)):"#NUM!":b?isNaN(a.substring(0,a.length-1))?"#NUM!":0:isNaN(a)?"#NUM!":a};b.IMSEC=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.IMDIV("1",b.IMCOS(a))};b.IMSECH=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.IMDIV("1",b.IMCOSH(a))};b.IMSIN=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a); a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.sin(c)*(Math.exp(d)+Math.exp(-d))/2,Math.cos(c)*(Math.exp(d)-Math.exp(-d))/2,a)};b.IMSINH=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);a=a.substring(a.length-1);a="i"===a||"j"===a?a:"i";return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.COMPLEX(Math.cos(d)*(Math.exp(c)-Math.exp(-c))/2,Math.sin(d)*(Math.exp(c)+Math.exp(-c))/2,a)};b.IMSQRT=function(a){var c=b.IMREAL(a), d=b.IMAGINARY(a),h=a.substring(a.length-1),h="i"===h||"j"===h?h:"i";if("#NUM!"===c||"#NUM!"===d)return"#NUM!";c=Math.sqrt(b.IMABS(a));a=b.IMARGUMENT(a);return b.COMPLEX(c*Math.cos(a/2),c*Math.sin(a/2),h)};b.IMSUB=function(a,c){var d=b.IMREAL(a),h=b.IMAGINARY(a),p=b.IMREAL(c),r=b.IMAGINARY(c),e=a.substring(a.length-1),f=a.substring(a.length-1),g="i";"j"===e?g="j":"j"===f&&(g="j");return"#NUM!"===d||"#NUM!"===h||"#NUM!"===p||"#NUM!"===r?"#NUM!":b.COMPLEX(d-p,h-r,g)};b.IMSUM=function(){for(var a=arguments[0], c=1;c<arguments.length;c++){var d=b.IMREAL(a),a=b.IMAGINARY(a),h=b.IMREAL(arguments[c]),p=b.IMAGINARY(arguments[c]);if("#NUM!"===d||"#NUM!"===a||"#NUM!"===h||"#NUM!"===p)return"#NUM!";a=b.COMPLEX(d+h,a+p)}return a};b.IMTAN=function(a){if(!0===a||!1===a)return"#VALUE!";var c=b.IMREAL(a),d=b.IMAGINARY(a);return"#NUM!"===c||"#NUM!"===d?"#NUM!":b.IMDIV(b.IMSIN(a),b.IMCOS(a))};b.OCT2BIN=function(a,c){if(!/^[0-7]{1,10}$/.test(a))return"#NUM!";var d=10===a.length&&"7"===a.substring(0,1)?!0:!1,b=d?parseInt(a, 8)-1073741824:parseInt(a,8);if(-512>b||511<b)return"#NUM!";if(d)return"1"+n.repeat("0",9-(512+b).toString(2).length)+(512+b).toString(2);d=b.toString(2);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.OCT2DEC=function(a){if(!/^[0-7]{1,10}$/.test(a))return"#NUM!";a=parseInt(a,8);return 536870912<=a?a-1073741824:a};b.OCT2HEX=function(a,c){if(!/^[0-7]{1,10}$/.test(a))return"#NUM!";var d=parseInt(a, 8);if(536870912<=d)return"ff"+(d+3221225472).toString(16);d=d.toString(16);if("undefined"===typeof c)return d;if(isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";c=Math.floor(c);return c>=d.length?n.repeat("0",c-d.length)+d:"#NUM!"};b.ACCRINT=function(a,c,d,h,p,r,e,f){if(!g(a).isValid()||!g(c).isValid()||!g(d).isValid())return"#VALUE!";if(0>=h||0>=p||-1===[1,2,4].indexOf(r)||-1===[0,1,2,3,4].indexOf(e)||0<=g(a).diff(g(d)))return"#NUM!";p="undefined"===typeof p?0:p;e="undefined"===typeof e?0:e;r=0;f= g(new Date(a));g(new Date(c));g(new Date(d));g([f.year()]).isLeapYear();switch(e){case 0:r=b.YEARFRAC(a,d,e);break;case 1:r=b.YEARFRAC(a,d,e);break;case 2:r=b.YEARFRAC(a,d,e);break;case 3:r=b.YEARFRAC(a,d,e);break;case 4:r=b.YEARFRAC(a,d,e)}return p*h*r};b.ACCRINTM=function(){};b.AMORDEGRC=function(){};b.AMORLINC=function(){};b.COUPDAYBS=function(){};b.COUPDAYS=function(){};b.COUPDAYSNC=function(){};b.COUPNCD=function(){};b.COUPNUM=function(){};b.COUPPCD=function(){};b.CUMIPMT=function(a,c,d,h,p, e){a=eval(a);c=eval(c);if(0>=a||0>=c||0>=d||1>h||1>p||h>p||0!==e&&1!==e)return"#NUM!";c=b.PMT(a,c,d,0,e);var f=0;1===h&&0===e&&(f=-d,h++);for(;h<=p;h++)f=1===e?f+(b.FV(a,h-2,c,d,1)-c):f+b.FV(a,h-1,c,d,0);return f*a};b.CUMPRINC=function(a,c,d,h,p,e){a=eval(a);c=eval(c);if(0>=a||0>=c||0>=d||1>h||1>p||h>p||0!==e&&1!==e)return"#NUM!";c=b.PMT(a,c,d,0,e);var f=0;1===h&&(f=0===e?c+d*a:c,h++);for(;h<=p;h++)f=0<e?f+(c-(b.FV(a,h-2,c,d,1)-c)*a):f+(c-b.FV(a,h-1,c,d,0)*a);return f};b.DB=function(a,c,d,b,p){p= "undefined"===typeof p?12:p;if(isNaN(a)||isNaN(c)||isNaN(d)||isNaN(b)||isNaN(p))return"#VALUE!";if(0>a||0>c||0>d||0>b||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(p)||b>d)return"#NUM!";if(c>=a)return 0;c=(1-Math.pow(c/a,1/d)).toFixed(3);for(var e=p=a*c*p/12,f=0,g=b===d?d-1:b,k=2;k<=g;k++)f=(a-e)*c,e+=f;return 1===b?p:b===d?(a-e)*c:f};b.DDB=function(a,c,d,b,p){p="undefined"===typeof p?2:p;if(isNaN(a)||isNaN(c)||isNaN(d)||isNaN(b)||isNaN(p))return"#VALUE!";if(0>a||0>c||0>d||0>b||0>=p||b>d)return"#NUM!"; if(c>=a)return 0;for(var e=0,f=0,g=1;g<=b;g++)f=Math.min(p/d*(a-e),a-c-e),e+=f;return f};b.DISC=function(){};b.DOLLARDE=function(a,c){if(isNaN(a)||isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";if(0<=c&&1>c)return"#DIV/0!";c=parseInt(c,10);var d=parseInt(a,10),d=d+a%1*Math.pow(10,Math.ceil(Math.log(c)/Math.LN10))/c,b=Math.pow(10,Math.ceil(Math.log(c)/Math.LN2)+1);return d=Math.round(d*b)/b};b.DOLLARFR=function(a,c){if(isNaN(a)||isNaN(c))return"#VALUE!";if(0>c)return"#NUM!";if(0<=c&&1>c)return"#DIV/0!"; c=parseInt(c,10);var d=parseInt(a,10);return d+=a%1*Math.pow(10,-Math.ceil(Math.log(c)/Math.LN10))*c};b.DURATION=function(){};b.EFFECT=function(a,c){if(isNaN(a)||isNaN(c))return"#VALUE!";if(0>=a||1>c)return"#NUM!";c=parseInt(c,10);return Math.pow(1+a/c,c)-1};b.FV=function(a,c,d,b,p){p="undefined"===typeof p?0:p;a=eval(a);0===a?a=b+d*c:(c=Math.pow(1+a,c),a=1===p?b*c+d*(1+a)*(c-1)/a:b*c+d*(c-1)/a);return-a};b.FVSCHEDULE=function(a,c){for(var d=a,b=0;b<c.length;b++){if(isNaN(c[b]))return"#VALUE!";d*= 1+c[b]}return d};b.INTRATE=function(){};b.IPMT=function(a,c,d,h,p,e){e="undefined"===typeof e?0:e;a=eval(a);d=eval(d);d=b.PMT(a,d,h,p,e);return(1===c?1===e?0:-h:1===e?b.FV(a,c-2,d,h,1)-d:b.FV(a,c-1,d,h,0))*a};b.IRR=function(a,c){for(var d=function(a,c,d){d+=1;for(var b=a[0],h=1;h<a.length;h++)b+=a[h]/Math.pow(d,(c[h]-c[0])/365);return b},b=function(a,c,d){d+=1;for(var b=0,h=1;h<a.length;h++)var e=(c[h]-c[0])/365,b=b-e*a[h]/Math.pow(d,e+1);return b},p=[],e=!1,f=!1,g=0;g<a.length;g++)p[g]=0===g?0:p[g- 1]+365,0<a[g]&&(e=!0),0>a[g]&&(f=!0);if(!e||!f)return"#NUM!";var e="undefined"===typeof c?.1:c,k,l,f=0,g=!0;do l=d(a,p,e),g=e-l/b(a,p,e),k=Math.abs(g-e),e=g,g=1E-10<k&&1E-10<Math.abs(l);while(g&&50>++f);return g?"#NUM!":e};b.ISPMT=function(a,c,d,b){a=eval(a);d=eval(d);return b*a*(c/d-1)};b.MDURATION=function(){};b.MIRR=function(a,c,d){for(var h=a.length,e=[],f=[],g=0;g<h;g++)0>a[g]?e.push(a[g]):f.push(a[g]);a=-b.NPV(d,f)*Math.pow(1+d,h-1);c=b.NPV(c,e)*(1+c);return Math.pow(a/c,1/(h-1))-1};b.NOMINAL= function(a,c){if(isNaN(a)||isNaN(c))return"#VALUE!";if(0>=a||1>c)return"#NUM!";c=parseInt(c,10);return(Math.pow(a+1,1/c)-1)*c};b.NPER=function(a,c,d,b,e){e="undefined"===typeof e?0:e;b="undefined"===typeof b?0:b;a=eval(a);return Math.log((c*(1+a*e)-b*a)/(d*a+c*(1+a*e)))/Math.log(1+a)};b.NPV=function(){for(var a=[],c=0;c<arguments.length;c++)a=a.concat(arguments[c]);for(var c=a[0],d=0,b=1;b<a.length;b++)d+=a[b]/Math.pow(1+c,b);return d};b.ODDFPRICE=function(){};b.ODDFYIELD=function(){};b.ODDLPRICE= function(){};b.ODDLYIELD=function(){};b.PDURATION=function(a,c,d){return isNaN(a)||isNaN(c)||isNaN(d)?"#VALUE!":0>=a?"#NUM!":(Math.log(d)-Math.log(c))/Math.log(1+a)};b.PMT=function(a,c,d,b,e){e="undefined"===typeof e?0:e;a=eval(a);c=eval(c);0===a?a=(d+b)/c:(c=Math.pow(1+a,c),a=1===e?(b*a/(c-1)+d*a/(1-1/c))/(1+a):b*a/(c-1)+d*a/(1-1/c));return-a};b.PPMT=function(a,c,d,h,e,f){return b.PMT(a,d,h,e,f)-b.IPMT(a,c,d,h,e,f)};b.PRICE=function(){};b.PRICEDISC=function(){};b.PRICEMAT=function(){};b.PV=function(a, c,d,b,e){e="undefined"===typeof e?0:e;a=eval(a);c=eval(c);return 0===a?-d*c-b:((1-Math.pow(1+a,c))/a*d*(1+a*e)-b)/Math.pow(1+a,c)};b.RATE=function(a,c,d,b,e,f){f="undefined"===typeof f?.01:f;b="undefined"===typeof b?0:b;e="undefined"===typeof e?0:e;a=eval(a);var g,k,l,m=0,n=g=0,q=f;1E-10>Math.abs(q)||(g=Math.exp(a*Math.log(1+q)));f=d+c*a+b;k=d*g+c*(1/q+e)*(g-1)+b;n=l=0;for(m=q;1E-10<Math.abs(f-k)&&50>n;)q=(k*l-f*m)/(k-f),l=m,m=q,1E-10>Math.abs(q)?g=d*(1+a*q)+c*(1+q*e)*a+b:(g=Math.exp(a*Math.log(1+ q)),g=d*g+c*(1/q+e)*(g-1)+b),f=k,k=g,++n;return q};b.RECEIVED=function(){};b.RRI=function(a,c,b){return isNaN(a)||isNaN(c)||isNaN(b)?"#VALUE!":0===a||0===c?"#NUM!":Math.pow(b/c,1/a)-1};b.SLN=function(a,c,b){return isNaN(a)||isNaN(c)||isNaN(b)?"#VALUE!":0===b?"#NUM!":(a-c)/b};b.SYD=function(a,c,b,h){if(isNaN(a)||isNaN(c)||isNaN(b)||isNaN(h))return"#VALUE!";if(0===b||1>h||h>b)return"#NUM!";h=parseInt(h,10);return(a-c)*(b-h+1)*2/(b*(b+1))};b.TBILLEQ=function(a,c,d){return g(a).isValid()&&g(c).isValid()? 0>=d||0<g(a).diff(g(c))||1<g(c).diff(g(a),"years")?"#NUM!":365*d/(360-d*b.DAYS360(a,c)):"#VALUE!"};b.TBILLPRICE=function(a,c,d){return g(a).isValid()&&g(c).isValid()?0>=d||0<g(a).diff(g(c))||1<g(c).diff(g(a),"years")?"#NUM!":100*(1-d*b.DAYS360(a,c)/360):"#VALUE!"};b.TBILLYIELD=function(a,c,d){return g(a).isValid()&&g(c).isValid()?0>=d||0<g(a).diff(g(c))||1<g(c).diff(g(a),"years")?"#NUM!":360*(100-d)/(d*b.DAYS360(a,c)):"#VALUE!"};b.VDB=function(){};b.XIRR=function(a,c,b){for(var h=function(a,c,b){b+= 1;for(var d=a[0],h=1;h<a.length;h++)d+=a[h]/Math.pow(b,g(c[h]).diff(g(c[0]),"days")/365);return d},e=function(a,c,b){b+=1;for(var d=0,h=1;h<a.length;h++)var e=g(c[h]).diff(g(c[0]),"days")/365,d=d-e*a[h]/Math.pow(b,e+1);return d},f=!1,k=!1,l=0;l<a.length;l++)0<a[l]&&(f=!0),0>a[l]&&(k=!0);if(!f||!k)return"#NUM!";b=b||.1;var m,f=0,k=!0;do m=h(a,c,b),k=b-m/e(a,c,b),l=Math.abs(k-b),b=k,k=1E-10<l&&1E-10<Math.abs(m);while(k&&50>++f);return k?"#NUM!":b};b.XNPV=function(a,c,b){for(var h=0,e=0;e<c.length;e++)h+= c[e]/Math.pow(1+a,g(b[e]).diff(g(b[0]),"days")/365);return h};b.YIELD=function(){};b.YIELDDISC=function(){};b.YIELDMAT=function(){};b.ISNUMBER=function(a){return!isNaN(parseFloat(a))&&isFinite(a)?!0:!1};b.AND=function(){for(var a=!0,c=0;c<arguments.length;c++)arguments[c]||(a=!1);return a};b.FALSE=function(){return!1};b.SWITCH=function(){var a;if(0<arguments.length){var c=arguments[0],b=arguments.length-1,h=Math.floor(b/2),e=!1,b=0===b%2?null:arguments[arguments.length-1];if(h)for(var f=0;f<h;f++)if(c=== arguments[2*f+1]){a=arguments[2*f+2];e=!0;break}!e&&b&&(a=b)}return a};b.IF=function(a,c,b){return a?"undefined"===typeof c?!0:c:"undefined"===typeof b?!0:b};b.IFERROR=function(a,c){return 0<="#DIV/0! #N/A #NAME? #NUM! #NULL! #REF! #VALUE!".split(" ").indexOf(a)?c:a};b.IFNA=function(a,c){return"#N/A"===a?c:a};b.NOT=function(a){return!a};b.OR=function(){for(var a=!1,c=0;c<arguments.length;c++)arguments[c]&&(a=!0);return a};b.TRUE=function(){return!0};b.XOR=function(){for(var a=0,c=0;c<arguments.length;c++)arguments[c]&& a++;return Math.floor(Math.abs(a))&1?!0:!1};b.REFERENCE=function(a,c){try{var b=c.split("."),h=a;e(b).forEach(function(a){if("]"===a[a.length-1]){var c=a.indexOf("["),b=a.substring(c+1,a.length-1);h=h[a.substring(0,c)][b]}else h=h[a]});return h}catch(f){}};b.ABS=function(a){return Math.abs(a)};b.ACOS=function(a){return Math.acos(a)};b.ACOSH=function(a){return Math.log(a+Math.sqrt(a*a-1))};b.ACOT=function(a){return Math.atan(1/a)};b.ACOTH=function(a){return.5*Math.log((a+1)/(a-1))};b.AGGREGATE=function(a, c){for(var d=[],h=2;h<arguments.length;h++)switch(a){case 1:d[h-2]=b.AVERAGE(arguments[h]);break;case 2:d[h-2]=b.COUNT(arguments[h]);break;case 3:d[h-2]=b.COUNTA(arguments[h]);break;case 4:d[h-2]=b.MAX(arguments[h]);break;case 5:d[h-2]=b.MIN(arguments[h]);break;case 6:d[h-2]=b.PRODUCT(arguments[h]);break;case 7:d[h-2]=b.STDEVS(arguments[h]);break;case 8:d[h-2]=b.STDEVP(arguments[h]);break;case 9:d[h-2]=b.SUM(arguments[h]);break;case 10:d[h-2]=b.VARS(arguments[h]);break;case 11:d[h-2]=b.VARP(arguments[h]); break;case 12:d[h-2]=b.MEDIAN(arguments[h]);break;case 13:d[h-2]=b.MODESNGL(arguments[h]);break;case 14:d[h-2]=b.LARGE(arguments[h]);break;case 15:d[h-2]=b.SMALL(arguments[h]);break;case 16:d[h-2]=b.PERCENTILEINC(arguments[h]);break;case 17:d[h-2]=b.QUARTILEINC(arguments[h]);break;case 18:d[h-2]=b.PERCENTILEEXC(arguments[h]);break;case 19:d[h-2]=b.QUARTILEEXC(arguments[h])}return d};b.ARABIC=function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))throw Error("Incorrect roman number"); var c=0;a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){c+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]});return c};b.ASIN=function(a){return Math.asin(a)};b.ASINH=function(a){return Math.log(a+Math.sqrt(a*a+1))};b.ATAN=function(a){return Math.atan(a)};b.ATAN2=function(a,c){return Math.atan2(a,c)};b.ATANH=function(a){return Math.log((1+a)/(1-a))/2};b.BASE=function(a,c,b){b="undefined"===typeof b?0:b;a=a.toString(c);return Array(Math.max(b+1-a.length,0)).join("0")+ a};b.CEILING=function(a,c,d){if(0===c)return 0;c="undefined"===typeof c?1:Math.abs(c);d="undefined"===typeof d?0:d;var h=-Math.floor(Math.log(c)/Math.log(10));return 0<=a?b.ROUND(Math.ceil(a/c)*c,h):0===d?-b.ROUND(Math.floor(Math.abs(a)/c)*c,h):-b.ROUND(Math.ceil(Math.abs(a)/c)*c,h)};b.CEILINGMATH=b.CEILING;b.CEILINGPRECISE=b.CEILING;b.COMBIN=function(a,c){return b.FACT(a)/(b.FACT(c)*b.FACT(a-c))};b.COMBINA=function(a,c){return 0===a&&0===c?1:b.COMBIN(a+c-1,a-1)};b.COS=function(a){return Math.cos(a)}; b.COSH=function(a){return(Math.exp(a)+Math.exp(-a))/2};b.COT=function(a){return 1/Math.tan(a)};b.COTH=function(a){a=Math.exp(2*a);return(a+1)/(a-1)};b.CSC=function(a){return 1/Math.sin(a)};b.CSCH=function(a){return 2/(Math.exp(a)-Math.exp(-a))};b.DECIMAL=function(a,c){return parseInt(a,c)};b.DEGREES=function(a){return 180*a/Math.PI};b.EVEN=function(a){return b.CEILING(a,-2,-1)};b.EXP=function(a){return Math.exp(a)};b.FACT=function(a){a=Math.floor(a);if(0===a||1===a)return 1;0<m[a]||(m[a]=b.FACT(a- 1)*a);return m[a]};b.FACTDOUBLE=function(a){a=Math.floor(a);return 0>=a?1:a*b.FACTDOUBLE(a-2)};b.FLOOR=function(a,c,d){if(0===c)return 0;c="undefined"===typeof c?1:Math.abs(c);d="undefined"===typeof d?0:d;var h=-Math.floor(Math.log(c)/Math.log(10));return 0<=a?b.ROUND(Math.floor(a/c)*c,h):0===d?-b.ROUND(Math.ceil(Math.abs(a)/c)*c,h):-b.ROUND(Math.floor(Math.abs(a)/c)*c,h)};b.FLOORMATH=b.FLOOR;b.FLOORPRECISE=b.FLOOR;b.GCD=function(){for(var a,c,b=arguments.length-1,h=arguments[b];b;)for(c=arguments[--b];a= c%h;c=h,h=a);return h};b.INT=function(a){return Math.floor(a)};b.ISEVEN=function(a){return Math.floor(Math.abs(a))&1?!1:!0};b.ISOCEILING=b.CEILING;b.ISODD=function(a){return Math.floor(Math.abs(a))&1?!0:!1};b.LCM=function(){for(var a=b.ARGSTOARRAY(arguments),c,d,h,e=1;void 0!==(h=a.pop());)for(;1<h;){if(h%2){c=3;for(d=Math.floor(Math.sqrt(h));c<=d&&h%c;c+=2);d=c<=d?c:h}else d=2;h/=d;e*=d;for(c=a.length;c;0===a[--c]%d&&1===(a[c]/=d)&&a.splice(c,1));}return e};b.LN=function(a){return Math.log(a)};b.LOG= function(a,c){c="undefined"===typeof c?10:c;return Math.log(a)/Math.log(c)};b.LOG10=function(a){return Math.log(a)/Math.log(10)};b.MDETERM=f.det;b.MINVERSE=f.inv;b.MMULT=f.dot;b.MOD=function(a,c){var b=Math.abs(a%c);return 0<c?b:-b};b.MROUND=function(a,c){if(0>a*c)throw Error("Number and multiple must have the same sign.");return Math.round(a/c)*c};b.MULTINOMIAL=function(){for(var a=0,c=1,d=0;d<arguments.length;d++)a+=arguments[d],c*=b.FACT(arguments[d]);return b.FACT(a)/c};b.MUNIT=f.identity;b.ODD= function(a){var c=Math.ceil(Math.abs(a)),c=c&1?c:c+1;return 0<a?c:-c};b.PI=function(){return Math.PI};b.POWER=function(a,c){return Math.pow(a,c)};b.PRODUCT=function(){for(var a=1,c=0;c<arguments.length;c++)a*=arguments[c];return a};b.QUOTIENT=function(a,c){return(a/c).toFixed(0)};b.RADIANS=function(a){return a*Math.PI/180};b.RAND=function(){return Math.random()};b.RANDBETWEEN=function(a,c){return a+Math.ceil((c-a+1)*Math.random())-1};b.ROUND=function(a,c){return Math.round(a*Math.pow(10,c))/Math.pow(10, c)};b.ROUNDDOWN=function(a,c){return(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};b.ROUNDUP=function(a,c){return(0<a?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};b.SERIESSUM=function(a,c,b,h){for(var e=h[0]*Math.pow(a,c),f=1;f<h.length;f++)e+=h[f]*Math.pow(a,c+f*b);return e};b.SEC=function(a){return 1/Math.cos(a)};b.SECH=function(a){return 2/(Math.exp(a)+Math.exp(-a))};b.SIGN=function(a){return 0>a?-1:0===a?0:1};b.SIN=function(a){return Math.sin(a)};b.SINH=function(a){return(Math.exp(a)- Math.exp(-a))/2};b.SQRT=function(a){return Math.sqrt(a)};b.SQRTPI=function(a){return Math.sqrt(a*Math.PI)};b.SUBTOTAL=function(a){for(var c=[],d=1;d<arguments.length;d++)switch(a){case 1:c[d-1]=b.AVERAGE(arguments[d]);break;case 2:c[d-1]=b.COUNT(arguments[d]);break;case 3:c[d-1]=b.COUNTA(arguments[d]);break;case 4:c[d-1]=b.MAX(arguments[d]);break;case 5:c[d-1]=b.MIN(arguments[d]);break;case 6:c[d-1]=b.PRODUCT(arguments[d]);break;case 7:c[d-1]=b.STDEV(arguments[d]);break;case 8:c[d-1]=b.STDEVP(arguments[d]); break;case 9:c[d-1]=b.SUM(arguments[d]);break;case 10:c[d-1]=b.VAR(arguments[d]);break;case 11:c[d-1]=b.VARP(arguments[d])}return c};b.SUM=function(){for(var a=b.ARGSTOARRAY(arguments),c=0,d=0;d<a.length;d++)if(a[d]instanceof Array)for(var h=0;h<a[d].length;h++)c+=b.ISNUMBER(a[d][h])?a[d][h]:0;else c+=b.ISNUMBER(a[d])?a[d]:0;return c};b.SUMIF=function(a,c){for(var b=0,h=0;h<a.length;h++)b+=eval(a[h]+c)?a[h]:0;return b};b.SUMIFS=function(){for(var a=(arguments.length-1)/2,c=arguments[0],b=0,h=0;h< c.length;h++){for(var e=!0,f=0;f<a;f++)eval(arguments[2*f+1][h]+arguments[2*f+2])||(e=!1);b+=e?c[h]:0}return b};b.SUMPRODUCT=function(){for(var a=arguments.length+1,c=0,b=0;b<arguments[0].length;b++)for(var h=0;h<arguments[0][b].length;h++){for(var e=1,f=1;f<a;f++)e*=arguments[f-1][b][h];c+=e}return c};b.SUMSQ=function(){for(var a=b.ARGSTOARRAY(arguments),c=0,d=0;d<a.length;d++)c+=b.ISNUMBER(a[d])?a[d]*a[d]:0;return c};b.SUMX2MY2=function(a,c){for(var b=0,h=0;h<a.length;h++)b+=a[h]*a[h]-c[h]*c[h]; return b};b.SUMX2PY2=function(a,c){for(var b=0,h=0;h<a.length;h++)b+=a[h]*a[h]+c[h]*c[h];return b};b.SUMXMY2=function(a,c){for(var b=0,h=0;h<a.length;h++)b+=Math.pow(a[h]-c[h],2);return b};b.TAN=function(a){return Math.tan(a)};b.TANH=function(a){a=Math.exp(2*a);return(a-1)/(a+1)};b.TRUNC=function(a,c){c="undefined"===typeof c?0:c;return(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};b.AVEDEV=function(){var a=b.ARGSCONCAT(arguments);return jStat.sum(jStat(a).subtract(jStat.mean(a)).abs()[0])/ a.length};b.AVERAGE=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,h=0,e=0;e<c;e++)!0!==a[e]&&!1!==a[e]&&(h+=a[e],d++);return h/d};b.AVERAGEA=function(){return jStat.mean(b.ARGSCONCAT(arguments))};b.AVERAGEIF=function(a,c,b){b="undefined"===typeof b?a:b;for(var h=0,e=0,f=0;f<a.length;f++)eval(a[f]+c)&&(e+=b[f],h++);return e/h};b.AVERAGEIFS=function(){for(var a=(arguments.length-1)/2,c=arguments[0],b=0,h=0,e=0;e<c.length;e++){for(var f=!0,g=0;g<a;g++)eval(arguments[2*g+1][e]+arguments[2* g+2])||(f=!1);f&&(h+=c[e],b++)}return h/b};b.BETADIST=function(a,c,b,h,e,f){e="undefined"===typeof e?0:e;a=(a-e)/(("undefined"===typeof f?1:f)-e);return h?jStat.beta.cdf(a,c,b):jStat.beta.pdf(a,c,b)};b.BETAINV=function(a,c,b,h,e){h="undefined"===typeof h?0:h;e="undefined"===typeof e?1:e;return jStat.beta.inv(a,c,b)*(e-h)+h};b.BINOMDIST=function(a,c,b,h){return h?jStat.binomial.cdf(a,c,b):jStat.binomial.pdf(a,c,b)};b.BINOMDISTRANGE=function(a,c,d,h){h="undefined"===typeof h?d:h;for(var e=0;d<=h;d++)e+= b.COMBIN(a,d)*Math.pow(c,d)*Math.pow(1-c,a-d);return e};b.BINOMINV=function(a,c,b){for(var h=0;h<=a;){if(jStat.binomial.cdf(h,a,c)>=b)return h;h++}};b.CHISQDIST=function(a,c,b){return b?jStat.chisquare.cdf(a,c):jStat.chisquare.pdf(a,c)};b.CHISQDISTRT=function(a,c){};b.CHISQINV=function(a,c){return jStat.chisquare.inv(a,c)};b.CHISQINVRT=function(){};b.CHISQTEST=function(){};b.CONFIDENCENORM=function(a,c,b){return jStat.normalci(1,a,c,b)[1]-1};b.CONFIDENCET=function(a,c,b){return jStat.tci(1,a,c,b)[1]- 1};b.CORREL=function(){return jStat.corrcoeff.apply(this,arguments)};b.COUNT=function(){return b.ARGSCONCAT(arguments).length};b.COUNTA=function(){var a=b.ARGSCONCAT(arguments);return a.length-b.COUNTBLANK(a)};b.COUNTBLANK=function(){for(var a=b.ARGSCONCAT(arguments),c=0,d=0;d<a.length;d++)null!==a[d]&&""!==a[d]||c++;return c};b.COUNTIF=function(a,c){for(var b=0,h=0;h<a.length;h++)a[h].match(new RegExp(c))&&b++;return b};b.COUNTIFS=function(){for(var a=(arguments.length-1)/2,c=arguments[0],b=0,h= 0;h<c.length;h++){for(var e=!0,f=0;f<a;f++)eval(arguments[2*f+1][h]+arguments[2*f+2])||(e=!1);b+=e?1:0}return b};b.COUNTUNIQUE=function(){return e.uniq(b.ARGSCONCAT(arguments)).length};b.COVARIANCEP=function(a,c){for(var b=jStat.mean(a),h=jStat.mean(c),e=0,f=a.length,g=0;g<f;g++)e+=(a[g]-b)*(c[g]-h);return e/f};b.COVARIANCES=function(){return jStat.covariance.apply(this,arguments)};b.DEVSQ=function(){for(var a=b.ARGSCONCAT(arguments),c=jStat.mean(a),d=0,h=0;h<a.length;h++)d+=Math.pow(a[h]-c,2);return d}; b.EXPONDIST=function(a,c,b){return b?jStat.exponential.cdf(a,c):jStat.exponential.pdf(a,c)};b.FDIST=function(a,c,b,h){return h?jStat.centralF.cdf(a,c,b):jStat.centralF.pdf(a,c,b)};b.FDISTRT=function(){};b.FINV=function(a,c,b){return jStat.centralF.inv(a,c,b)};b.FINVRT=function(){};b.FTEST=function(){};b.FISHER=function(a){return Math.log((1+a)/(1-a))/2};b.FISHERINV=function(a){a=Math.exp(2*a);return(a-1)/(a+1)};b.FORECAST=function(a,c,b){for(var h=jStat.mean(b),e=jStat.mean(c),f=b.length,g=0,k=0, l=0;l<f;l++)g+=(b[l]-h)*(c[l]-e),k+=Math.pow(b[l]-h,2);c=g/k;return e-c*h+c*a};b.FREQUENCY=function(a,c){for(var b=a.length,h=c.length,e=[],f=0;f<=h;f++)for(var g=e[f]=0;g<b;g++)0===f?a[g]<=c[0]&&(e[0]+=1):f<h?a[g]>c[f-1]&&a[g]<=c[f]&&(e[f]+=1):f===h&&a[g]>c[h-1]&&(e[h]+=1);return e};b.GAMMA=function(){return jStat.gammafn.apply(this,arguments)};b.GAMMADIST=function(a,c,b,e){};b.GAMMAINV=function(a,c,b){};b.GAMMALN=function(){return jStat.gammaln.apply(this,arguments)};b.GAMMALNPRECISE=function(){}; b.GAUSS=function(a){return jStat.normal.cdf(a,0,1)-.5};b.GEOMEAN=function(){return jStat.geomean(b.ARGSCONCAT(arguments))};b.GROWTH=function(a,c,b,e){var f;if("undefined"===typeof c)for(c=[],f=1;f<=a.length;f++)c.push(f);if("undefined"===typeof b)for(b=[],f=1;f<=a.length;f++)b.push(f);"undefined"===typeof e&&(e=!0);var g=a.length,k=0,l=0,m=0,n=0;for(f=0;f<g;f++)var q=c[f],s=Math.log(a[f]),k=k+q,l=l+s,m=m+q*s,n=n+q*q;k/=g;l/=g;m/=g;n/=g;e?(a=(m-k*l)/(n-k*k),k=l-a*k):(a=m/n,k=0);l=[];for(f=0;f<b.length;f++)l.push(Math.exp(k+ a*b[f]));return l};b.HARMEAN=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=0;e<c;e++)d+=1/a[e];return c/d};b.HYPGEOMDIST=function(a,c,d,e,f){function g(a,c,d,e){return b.COMBIN(d,a)*b.COMBIN(e-d,c-a)/b.COMBIN(e,c)}function k(a,c,b,d){for(var e=0,h=0;h<=a;h++)e+=g(h,c,b,d);return e}return f?k(a,c,d,e):g(a,c,d,e)};b.INTERCEPT=function(a,c){return b.FORECAST(0,a,c)};b.KURT=function(){for(var a=b.ARGSCONCAT(arguments),c=jStat.mean(a),d=a.length,e=0,f=0;f<d;f++)e+=Math.pow(a[f]-c,4);e/= Math.pow(jStat.stdev(a,!0),4);return d*(d+1)/((d-1)*(d-2)*(d-3))*e-3*(d-1)*(d-1)/((d-2)*(d-3))};b.LARGE=function(a,c){return a.sort(function(a,c){return c-a})[c-1]};b.LINEST=function(a,c){for(var b=jStat.mean(c),e=jStat.mean(a),f=c.length,g=0,k=0,l=0;l<f;l++)g+=(c[l]-b)*(a[l]-e),k+=Math.pow(c[l]-b,2);f=g/k;return[f,e-f*b]};b.LOGEST=function(){};b.LOGNORMDIST=function(a,c,b,e){return e?jStat.lognormal.cdf(a,c,b):jStat.lognormal.pdf(a,c,b)};b.LOGNORMINV=function(a,c,b){return jStat.lognormal.inv(a, c,b)};b.MAX=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0<c?a[0]:0,e=0;e<c;e++)d=a[e]>d&&!0!==a[e]&&!1!==a[e]?a[e]:d;return d};b.MAXA=function(){var a=b.ARGSCONCAT(arguments);return 0<a.length?Math.max.apply(Math,a):0};b.MEDIAN=function(){return jStat.median(b.ARGSCONCAT(arguments))};b.MIN=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0<c?a[0]:0,e=0;e<c;e++)d=a[e]<d&&!0!==a[e]&&!1!==a[e]?a[e]:d;return d};b.MINA=function(){var a=b.ARGSCONCAT(arguments);return 0<a.length?Math.min.apply(Math, a):0};b.MODEMULT=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d={},e=[],f=0,g,k=0;k<c;k++)g=a[k],d[g]=d[g]?d[g]+1:1,d[g]>f&&(f=d[g],e=[]),d[g]===f&&(e[e.length]=g);return e};b.MODESNGL=function(){return b.MODEMULT(b.ARGSCONCAT(arguments)).sort(function(a,c){return a-c})[0]};b.NEGBINOMDIST=function(a,c,b,e){return e?jStat.negbin.cdf(a,c,b):jStat.negbin.pdf(a,c,b)};b.NORMDIST=function(a,c,b,e){return isNaN(a)||isNaN(c)||isNaN(b)?"#VALUE!":0>=b?"#NUM!":e?jStat.normal.cdf(a,c,b):jStat.normal.pdf(a, c,b)};b.NORMINV=function(a,c,b){return jStat.normal.inv(a,c,b)};b.NORMSDIST=function(a,c){return c?jStat.normal.cdf(a,0,1):jStat.normal.pdf(a,0,1)};b.NORMSINV=function(a){return jStat.normal.inv(a,0,1)};b.PEARSON=function(a,c){for(var b=jStat.mean(a),e=jStat.mean(c),f=a.length,g=0,k=0,l=0,m=0;m<f;m++)g+=(a[m]-b)*(c[m]-e),k+=Math.pow(a[m]-b,2),l+=Math.pow(c[m]-e,2);return g/Math.sqrt(k*l)};b.PERCENTILEEXC=function(a,c){a=a.sort(function(a,c){return a-c});var d=a.length;if(c<1/(d+1)||c>1-1/(d+1))return"#NUM!"; var d=c*(d+1)-1,e=Math.floor(d);return b.CLEANFLOAT(d===e?a[d]:a[e]+(d-e)*(a[e+1]-a[e]))};b.PERCENTILEINC=function(a,c){a=a.sort(function(a,c){return a-c});var d=c*(a.length-1),e=Math.floor(d);return b.CLEANFLOAT(d===e?a[d]:a[e]+(d-e)*(a[e+1]-a[e]))};b.PERCENTRANKEXC=function(a,c,b){a=a.sort(function(a,c){return a-c});var f=e.uniq(a),g=a.length,k=f.length;b=Math.pow(10,"undefined"===typeof b?3:b);for(var l=0,m=!1,n=0;!m&&n<k;)c===f[n]?(l=(a.indexOf(f[n])+1)/(g+1),m=!0):c>=f[n]&&(c<f[n+1]||n===k-1)&& (l=(a.indexOf(f[n])+1+(c-f[n])/(f[n+1]-f[n]))/(g+1),m=!0),n++;return Math.floor(l*b)/b};b.PERCENTRANKINC=function(a,c,b){a=a.sort(function(a,c){return a-c});var f=e.uniq(a),g=a.length,k=f.length;b=Math.pow(10,"undefined"===typeof b?3:b);for(var l=0,m=!1,n=0;!m&&n<k;)c===f[n]?(l=a.indexOf(f[n])/(g-1),m=!0):c>=f[n]&&(c<f[n+1]||n===k-1)&&(l=(a.indexOf(f[n])+(c-f[n])/(f[n+1]-f[n]))/(g-1),m=!0),n++;return Math.floor(l*b)/b};b.PERMUT=function(a,c){return b.FACT(a)/b.FACT(a-c)};b.PERMUTATIONA=function(a, c){return Math.pow(a,c)};b.PHI=function(a){return Math.exp(-.5*a*a)/2.5066282746310002};b.POISSONDIST=function(a,c,b){return b?jStat.poisson.cdf(a,c):jStat.poisson.pdf(a,c)};b.PROB=function(a,c,b,e){if("undefined"===typeof b)return 0;e="undefined"===typeof e?b:e;if(b===e)return 0<=a.indexOf(b)?c[a.indexOf(b)]:0;for(var f=a.sort(function(a,c){return a-c}),g=f.length,k=0,l=0;l<g;l++)f[l]>=b&&f[l]<=e&&(k+=c[a.indexOf(f[l])]);return k};b.QUARTILEEXC=function(a,c){switch(c){case 1:return b.PERCENTILEEXC(a, .25);case 2:return b.PERCENTILEEXC(a,.5);case 3:return b.PERCENTILEEXC(a,.75);default:return"#NUM!"}};b.QUARTILEINC=function(a,c){switch(c){case 1:return b.PERCENTILEINC(a,.25);case 2:return b.PERCENTILEINC(a,.5);case 3:return b.PERCENTILEINC(a,.75);default:return"#NUM!"}};b.RANKAVG=function(a,c,d){c=c.sort(("undefined"===typeof d?0:d)?function(a,c){return a-c}:function(a,c){return c-a});d=b.COUNTIN(c,a);return 1<d?(2*c.indexOf(a)+d+1)/2:c.indexOf(a)+1};b.RANKEQ=function(a,c,b){c=c.sort(("undefined"=== typeof b?0:b)?function(a,c){return a-c}:function(a,c){return c-a});return c.indexOf(a)+1};b.RSQ=function(a,c){return Math.pow(b.PEARSON(a,c),2)};b.SKEW=function(){for(var a=b.ARGSCONCAT(arguments),c=jStat.mean(a),d=a.length,e=0,f=0;f<d;f++)e+=Math.pow(a[f]-c,3);return d*e/((d-1)*(d-2)*Math.pow(jStat.stdev(a,!0),3))};b.SKEWP=function(){for(var a=b.ARGSCONCAT(arguments),c=jStat.mean(a),d=a.length,e=0,f=0,g=0;g<d;g++)f+=Math.pow(a[g]-c,3),e+=Math.pow(a[g]-c,2);return f/d/Math.pow(e/d,1.5)};b.SLOPE=function(a, c){for(var b=jStat.mean(c),e=jStat.mean(a),f=c.length,g=0,k=0,l=0;l<f;l++)g+=(c[l]-b)*(a[l]-e),k+=Math.pow(c[l]-b,2);return g/k};b.SMALL=function(a,c){return a.sort(function(a,c){return a-c})[c-1]};b.STANDARDIZE=function(a,c,b){return(a-c)/b};b.STDEVA=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=jStat.mean(a),f=0;f<c;f++)d+=Math.pow(a[f]-e,2);return Math.sqrt(d/(c-1))};b.STDEVP=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=0,f=b.AVERAGE(a),g=0;g<c;g++)!0!==a[g]&&!1!== a[g]&&(d+=Math.pow(a[g]-f,2),e++);return Math.sqrt(d/e)};b.STDEVPA=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=jStat.mean(a),f=0;f<c;f++)d+=Math.pow(a[f]-e,2);return Math.sqrt(d/c)};b.STDEVS=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=0,f=b.AVERAGE(a),g=0;g<c;g++)!0!==a[g]&&!1!==a[g]&&(d+=Math.pow(a[g]-f,2),e++);return Math.sqrt(d/(e-1))};b.STEYX=function(a,c){for(var b=jStat.mean(c),e=jStat.mean(a),f=c.length,g=0,k=0,l=0,m=0;m<f;m++)g+=Math.pow(a[m]-e,2),k+=(c[m]- b)*(a[m]-e),l+=Math.pow(c[m]-b,2);return Math.sqrt((g-k*k/l)/(f-2))};b.TDIST=function(a,c,b){return b?jStat.studentt.cdf(a,c):jStat.studentt.pdf(a,c)};b.TDIST2T=function(){};b.TDISTRT=function(){};b.TINV=function(a,c){return jStat.studentt.inv(a,c)};b.TINV2T=function(){};b.TTEST=function(){};b.TREND=function(){};b.TRIMMEAN=function(a,c){var d=b.FLOOR(a.length*c,2)/2;return jStat.mean(e.initial(e.rest(a.sort(function(a,c){return a-c}),d),d))};b.VARA=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length, d=0,e=jStat.mean(a),f=0;f<c;f++)d+=Math.pow(a[f]-e,2);return d/(c-1)};b.VARP=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=0,f=b.AVERAGE(a),g=0;g<c;g++)!0!==a[g]&&!1!==a[g]&&(d+=Math.pow(a[g]-f,2),e++);return d/e};b.VARPA=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=jStat.mean(a),f=0;f<c;f++)d+=Math.pow(a[f]-e,2);return d/c};b.VARS=function(){for(var a=b.ARGSCONCAT(arguments),c=a.length,d=0,e=0,f=b.AVERAGE(a),g=0;g<c;g++)!0!==a[g]&&!1!==a[g]&&(d+=Math.pow(a[g]-f,2), e++);return d/(e-1)};b.WEIBULLDIST=function(a,c,b,e){return e?1-Math.exp(-Math.pow(a/b,c)):Math.pow(a,c-1)*Math.exp(-Math.pow(a/b,c))*c/Math.pow(b,c)};b.ZTEST=function(a,c,d){var e=a.length;d="undefined"===typeof d?b.STDEVS(a):d;return 1-b.NORMSDIST((b.AVERAGE(a)-c)/(d/Math.sqrt(e)),b.TRUE)};b.CHAR=function(a){return String.fromCharCode(a)};b.CLEAN=function(a){return a.replace(/[\0-\x1F]/g,"")};b.CODE=function(a){return a.charCodeAt(0)};b.CONCATENATE=function(){for(var a="",c=0;c<arguments.length;c++)null!== arguments[c]&&void 0!==arguments[c]&&(a+=arguments[c]);return a};b.DOLLAR=function(a,c){c="undefined"===typeof c?2:c;var b="";0>=c?(a=Math.round(a*Math.pow(10,c))/Math.pow(10,c),b="($0,0)"):0<c&&(b="($0,0."+Array(c+1).join("0")+")");return k(a).format(b)};b.EXACT=function(a,c){return a===c};b.FIND=function(a,c,b){return c?c.indexOf(a,("undefined"===typeof b?0:b)-1)+1:null};b.FIXED=function(a,c,b){c="undefined"===typeof c?2:c;b=("undefined"===typeof b?0:b)?"0":"0,0";0>=c?a=Math.round(a*Math.pow(10, c))/Math.pow(10,c):0<c&&(b+="."+Array(c+1).join("0"));return k(a).format(b)};b.HTML2TEXT=function(a){var b="";a&&(a instanceof Array?a.forEach(function(a){""!==b&&(b+="\n");b+=a.replace(/<(?:.|\n)*?>/gm,"")}):b=a.replace(/<(?:.|\n)*?>/gm,""));return b};b.HUMANIZE=function(a){return a instanceof Date?(a=g(a),a.hours()||a.minutes()||a.seconds()?a.format("dddd, MMMM Do YYYY, h:mm:ss"):a.format("dddd, MMMM Do YYYY")):a};b.JOIN=function(a,b){return a.join(b)};b.LEFT=function(a,b){return a?a.substring(0, "undefined"===typeof b?1:b):null};b.LEN=function(a){return a?a.length:0};b.LOWER=function(a){return a?a.toLowerCase():a};b.MID=function(a,b,d){return a.substring(b-1,d)};b.NUMBERVALUE=function(a,b,d){d="undefined"===typeof d?",":d;return Number(a.replace("undefined"===typeof b?".":b,".").replace(d,""))};b.PROPER=function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})};b.REGEXEXTRACT=function(a,b){var d=a.match(new RegExp(b));return d?d[0]:null}; b.REGEXMATCH=function(a,b,d){var e=a.match(new RegExp(b));return d?e:a.match(new RegExp(b))?!0:!1};b.REGEXREPLACE=function(a,b,d){return a.replace(new RegExp(b),d)};b.REPLACE=function(a,b,d,e){return a.substr(0,b-1)+e+a.substr(b-1+d)};b.REPT=function(a,b){return Array(b+1).join(a)};b.RIGHT=function(a,b){return a?a.substring(a.length-("undefined"===typeof b?1:b)):null};b.ROMAN=function(a){a=String(a).split("");for(var b=" C CC CCC CD D DC DCC DCCC CM X XX XXX XL L LX LXX LXXX XC I II III IV V VI VII VIII IX".split(" "), d="",e=3;e--;)d=(b[+a.pop()+10*e]||"")+d;return Array(+a.join("")+1).join("M")+d};b.SEARCH=function(a,b,d){d="undefined"===typeof d?0:d;return b.toLowerCase().indexOf(a.toLowerCase(),d-1)+1};b.SPLIT=function(a,b){return n.words(a,b)};b.SUBSTITUTE=function(a,b,d,e){if(a&&b&&d){if("undefined"===typeof e)return a.replace(new RegExp(b,"g"),d);for(var f=0,g=0;0<a.indexOf(b,f);)if(f=a.indexOf(b,f+1),g++,g===e)return a.substring(0,f)+d+a.substring(f+b.length)}else return a};b.T=function(a){return"string"=== typeof a?a:null};b.TEXT=function(a,b){var d="";if(a)if(a instanceof Object)try{d=JSON.stringify(a)}catch(e){}else"string"===typeof a?d=b?0<=b.indexOf("0")?k(a).format(b):g(new Date(a)).format(b):a:a.toString&&"function"===typeof a.toString&&(d=a.toString());return d};b.TRIM=function(a){return n.clean(a)};b.UNICHAR=b.CHAR;b.UNICODE=b.CODE;b.UPPER=function(a){return a.toUpperCase()};b.VALUE=function(a){return k().unformat(a)};b.MD5=function(a,b,d){return s(a,b,d).toString()};b.NUMERAL=function(a,b){return k(a).format(b)}; return b}(numeric,numeral,jStat,moment,_,_.str,CryptoJS)},utility:{toChr:function(f){var k="";for(f-=1;0<=f;)k=String.fromCharCode(f%26+97)+k,f=Math.floor(f/26)-1;return k.toUpperCase()},toNum:function(f){f=f.split("");var k="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),l,g,e=0;l=0;for(g=f.length-1;l<f.length;l+=1,g-=1)e+=Math.pow(k.length,g)*(k.indexOf(f[l])+1);return e},cellRange:function(f,k){var l=/[A-Z]+/,g=/[0-9]+/,e=f.toUpperCase(),n=k.toUpperCase(),q=this.toNum(e.match(l)[0]),l=this.toNum(n.match(l)[0]), e=parseInt(e.match(g)[0],10),g=parseInt(n.match(g)[0],10),n=[],b,s;for(s=q;s<=l;s++)for(b=e;b<=g;b++)q=this.toChr(s)+b,n.push(q);return n}}};var t={sheetRegistry:{},init:function(f){this.each(function(){var g="CALX"+(new Date).valueOf();t.sheetRegistry[g]=new n(g,this,f)});for(var k in t.sheetRegistry){t.sheetRegistry[k].buildCellDependency();var l=t.sheetRegistry[k].checkCircularReference();l.isCircular&&(l="Circular reference detected, this may cause calx to stop working.\ncell : "+l.cell.getAddress()+ "\nformula : "+l.cell.getFormula()+"\n\nPlease check each cells involved in the formula that has direct or indirect reference to "+l.cell.getAddress(),alert(l),s.error(l))}return this},registerFunction:function(f){},scan:function(f){},update:function(f){},getSheet:function(){var f=s(this).attr("data-calx-identifier");return"undefined"==typeof t.sheetRegistry[f]?!1:t.sheetRegistry[f]},getCell:function(f){var k=s(this).attr("data-calx-identifier");$sheet=t.sheetRegistry[k];return $sheet.getCell(f)}, evaluate:function(f){var k=s(this).attr("data-calx-identifier");$sheet=t.sheetRegistry[k];return $sheet.evaluate(f)},destroy:function(){this.each(function(){var f=s(this),k=f.attr("data-calx-identifier");f.removeAttr("data-calx-identifier");delete t.sheetRegistry[k]});return this}};s.fn.calx=function(f,k){if(t[f])return t[f].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof f||"undefined"==typeof f)return t.init.apply(this,arguments);s.error("Method "+method+" does not exist on jQuery.calx")}})(jQuery);