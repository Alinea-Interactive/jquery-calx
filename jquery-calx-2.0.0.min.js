(function(n){function E(a){function b(){this.yy={}}var c={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,"=":11,"+":12,"(":13,")":14,"[":15,expseq:16,"]":17,"<":18,">":19,NOT:20,"-":21,"*":22,"/":23,"^":24,E:25,FUNCTION:26,cell:27,FIXEDCELL:28,":":29,CELL:30,SHEET:31,";":32,",":33,VARIABLE:34,DECIMAL:35,NUMBER:36,"%":37,"#":38,"!":39,$accept:0,$end:1},terminals_:{5:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"=",12:"+", 13:"(",14:")",15:"[",17:"]",18:"<",19:">",20:"NOT",21:"-",22:"*",23:"/",24:"^",25:"E",26:"FUNCTION",28:"FIXEDCELL",29:":",30:"CELL",31:"SHEET",32:";",33:",",34:"VARIABLE",35:"DECIMAL",36:"NUMBER",37:"%",38:"#",39:"!"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,1],[4,3],[4,4],[4,1],[4,1],[4,2],[27,1],[27,3],[27,1],[27,3],[27,3],[27,5],[16,1],[16,3],[16,3],[6,1],[6,3],[9,1],[9,3],[9,2],[2,3], [2,4]],performAction:function(b,c,d,m,h,l,g){b=l.length-1;switch(h){case 1:return l[b-1];case 2:this.$=a.getVariable(l[b]);break;case 3:this.$=a.time(l[b]);break;case 4:this.$=a.time(l[b]);break;case 5:this.$=1*l[b];isNaN(this.$)&&(this.$=0);break;case 6:this.$=l[b].substring(1,l[b].length-1);break;case 7:this.$=a.comparator.equal(l[b-2],l[b]);break;case 8:this.$=1*l[b-2]+1*l[b];break;case 9:this.$=1*l[b-1];break;case 10:this.$=l[b-1];break;case 11:this.$=a.comparator.lessEqual(l[b-3],l[b-1]);break; case 12:this.$=a.comparator.greaterEqual(l[b-3],l[b-1]);break;case 13:this.$=1*l[b-3]!=1*l[b];break;case 14:this.$=l[b-2]!=l[b];break;case 15:this.$=a.comparator.greater(l[b-2],l[b]);break;case 16:this.$=a.comparator.less(l[b-2],l[b]);break;case 17:this.$=1*l[b-2]-1*l[b];break;case 18:this.$=1*l[b-2]*l[b];break;case 19:this.$=0==1*l[b]?"#DIV/0!":1*l[b-2]/(1*l[b]);break;case 20:this.$=Math.pow(1*l[b-2],1*l[b]);break;case 21:this.$=-1*l[b];isNaN(this.$)&&(this.$=0);break;case 22:this.$=1*l[b];isNaN(this.$)&& (this.$=0);break;case 23:this.$=Math.E;break;case 24:this.$=a.callFunction(l[b-2]);break;case 25:this.$=a.callFunction(l[b-3],l[b-1]);break;case 29:this.$=a.getCellValue(l[b]);break;case 30:this.$=a.getCellRangeValue(l[b-2],l[b]);break;case 31:this.$=a.getCellValue(l[b]);break;case 32:this.$=a.getCellRangeValue(l[b-2],l[b]);break;case 33:this.$=a.getRemoteCellValue(l[b-2],l[b]);break;case 34:this.$=a.getRemoteCellRangeValue(l[b-4],l[b-2],l[b]);break;case 35:this.$=[l[b]];break;case 36:l[b-2].push(l[b]); this.$=l[b-2];break;case 37:l[b-2].push(l[b]);this.$=l[b-2];break;case 38:this.$=[l[b]];break;case 39:this.$=n.isArray(l[b-2])?l[b-2]:[l[b-2]];this.$.push(l[b]);break;case 40:this.$=1*l[b];break;case 41:this.$=1*(l[b-2]+"."+l[b]);break;case 42:this.$=.01*l[b-1];break;case 43:this.$=l[b-2]+l[b-1]+l[b];break;case 44:this.$=l[b-2]+l[b-1]+l[b]}},table:[{2:15,3:1,4:2,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16], 36:[1,17],38:[1,21]},{1:[3]},{5:[1,22],11:[1,23],12:[1,24],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31]},{5:[2,2],11:[2,2],12:[2,2],14:[2,2],17:[2,2],18:[2,2],19:[2,2],20:[2,2],21:[2,2],22:[2,2],23:[2,2],24:[2,2],32:[2,2],33:[2,2],35:[1,32]},{5:[2,3],11:[2,3],12:[2,3],14:[2,3],17:[2,3],18:[2,3],19:[2,3],20:[2,3],21:[2,3],22:[2,3],23:[2,3],24:[2,3],32:[2,3],33:[2,3]},{5:[2,4],11:[2,4],12:[2,4],14:[2,4],17:[2,4],18:[2,4],19:[2,4],20:[2,4],21:[2,4],22:[2,4],23:[2,4],24:[2,4], 32:[2,4],33:[2,4]},{5:[2,5],11:[2,5],12:[2,5],14:[2,5],17:[2,5],18:[2,5],19:[2,5],20:[2,5],21:[2,5],22:[2,5],23:[2,5],24:[2,5],32:[2,5],33:[2,5],37:[1,33]},{5:[2,6],11:[2,6],12:[2,6],14:[2,6],17:[2,6],18:[2,6],19:[2,6],20:[2,6],21:[2,6],22:[2,6],23:[2,6],24:[2,6],32:[2,6],33:[2,6]},{2:15,4:34,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:36,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1, 11],13:[1,8],15:[1,9],16:35,21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:37,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:38,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,23],11:[2,23],12:[2,23],14:[2,23], 17:[2,23],18:[2,23],19:[2,23],20:[2,23],21:[2,23],22:[2,23],23:[2,23],24:[2,23],32:[2,23],33:[2,23]},{13:[1,39]},{5:[2,26],11:[2,26],12:[2,26],14:[2,26],17:[2,26],18:[2,26],19:[2,26],20:[2,26],21:[2,26],22:[2,26],23:[2,26],24:[2,26],32:[2,26],33:[2,26]},{2:40,5:[2,27],11:[2,27],12:[2,27],14:[2,27],17:[2,27],18:[2,27],19:[2,27],20:[2,27],21:[2,27],22:[2,27],23:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[1,41],38:[1,21]},{5:[2,38],11:[2,38],12:[2,38],14:[2,38],17:[2,38],18:[2,38],19:[2,38],20:[2,38],21:[2, 38],22:[2,38],23:[2,38],24:[2,38],32:[2,38],33:[2,38],35:[2,38],38:[1,42]},{5:[2,40],11:[2,40],12:[2,40],14:[2,40],17:[2,40],18:[2,40],19:[2,40],20:[2,40],21:[2,40],22:[2,40],23:[2,40],24:[2,40],32:[2,40],33:[2,40],35:[1,43],37:[2,40]},{5:[2,29],11:[2,29],12:[2,29],14:[2,29],17:[2,29],18:[2,29],19:[2,29],20:[2,29],21:[2,29],22:[2,29],23:[2,29],24:[2,29],29:[1,44],32:[2,29],33:[2,29]},{5:[2,31],11:[2,31],12:[2,31],14:[2,31],17:[2,31],18:[2,31],19:[2,31],20:[2,31],21:[2,31],22:[2,31],23:[2,31],24:[2, 31],29:[1,45],32:[2,31],33:[2,31]},{19:[1,46]},{34:[1,47]},{1:[2,1]},{2:15,4:48,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:49,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:52,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],11:[1,50],12:[1,11],13:[1,8],15:[1,9],19:[1,51],21:[1, 10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:54,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],11:[1,53],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:55,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:56,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8], 15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:57,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:58,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:59,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1, 8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{34:[1,60]},{5:[2,42],11:[2,42],12:[2,42],14:[2,42],17:[2,42],18:[2,42],19:[2,42],20:[2,42],21:[2,42],22:[2,42],23:[2,42],24:[2,42],32:[2,42],33:[2,42],37:[2,42]},{11:[1,23],12:[1,24],14:[1,61],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31]},{17:[1,62],32:[1,63],33:[1,64]},{11:[1,23],12:[1,24],14:[2,35],17:[2,35],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1, 30],24:[1,31],32:[2,35],33:[2,35]},{5:[2,21],11:[2,21],12:[2,21],14:[2,21],17:[2,21],18:[2,21],19:[2,21],20:[2,21],21:[2,21],22:[1,29],23:[1,30],24:[1,31],32:[2,21],33:[2,21]},{5:[2,22],11:[2,22],12:[2,22],14:[2,22],17:[2,22],18:[2,22],19:[2,22],20:[2,22],21:[2,22],22:[1,29],23:[1,30],24:[1,31],32:[2,22],33:[2,22]},{2:15,4:36,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],14:[1,65],15:[1,9],16:66,21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]}, {5:[2,28],11:[2,28],12:[2,28],14:[2,28],17:[2,28],18:[2,28],19:[2,28],20:[2,28],21:[2,28],22:[2,28],23:[2,28],24:[2,28],32:[2,28],33:[2,28]},{38:[1,42]},{34:[1,67]},{36:[1,68]},{28:[1,69]},{30:[1,70]},{30:[1,71]},{39:[1,72]},{5:[2,7],11:[2,7],12:[1,24],14:[2,7],17:[2,7],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,7],33:[2,7]},{5:[2,8],11:[2,8],12:[2,8],14:[2,8],17:[2,8],18:[2,8],19:[2,8],20:[2,8],21:[2,8],22:[1,29],23:[1,30],24:[1,31],32:[2,8],33:[2,8]},{2:15,4:73, 6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:74,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,16],11:[2,16],12:[1,24],14:[2,16],17:[2,16],18:[2,16],19:[2,16],20:[2,16],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,16],33:[2,16]},{2:15,4:75,6:3,7:[1,4],8:[1,5],9:6, 10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,15],11:[2,15],12:[1,24],14:[2,15],17:[2,15],18:[2,15],19:[2,15],20:[2,15],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,15],33:[2,15]},{5:[2,14],11:[2,14],12:[1,24],14:[2,14],17:[2,14],18:[1,25],19:[1,26],20:[2,14],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,14],33:[2,14]},{5:[2,17],11:[2,17],12:[2,17],14:[2,17],17:[2,17],18:[2,17],19:[2,17],20:[2,17],21:[2, 17],22:[1,29],23:[1,30],24:[1,31],32:[2,17],33:[2,17]},{5:[2,18],11:[2,18],12:[2,18],14:[2,18],17:[2,18],18:[2,18],19:[2,18],20:[2,18],21:[2,18],22:[2,18],23:[2,18],24:[1,31],32:[2,18],33:[2,18]},{5:[2,19],11:[2,19],12:[2,19],14:[2,19],17:[2,19],18:[2,19],19:[2,19],20:[2,19],21:[2,19],22:[2,19],23:[2,19],24:[1,31],32:[2,19],33:[2,19]},{5:[2,20],11:[2,20],12:[2,20],14:[2,20],17:[2,20],18:[2,20],19:[2,20],20:[2,20],21:[2,20],22:[2,20],23:[2,20],24:[2,20],32:[2,20],33:[2,20]},{5:[2,39],11:[2,39],12:[2, 39],14:[2,39],17:[2,39],18:[2,39],19:[2,39],20:[2,39],21:[2,39],22:[2,39],23:[2,39],24:[2,39],32:[2,39],33:[2,39],35:[2,39]},{5:[2,9],11:[2,9],12:[2,9],14:[2,9],17:[2,9],18:[2,9],19:[2,9],20:[2,9],21:[2,9],22:[2,9],23:[2,9],24:[2,9],32:[2,9],33:[2,9]},{5:[2,10],11:[2,10],12:[2,10],14:[2,10],17:[2,10],18:[2,10],19:[2,10],20:[2,10],21:[2,10],22:[2,10],23:[2,10],24:[2,10],32:[2,10],33:[2,10]},{2:15,4:76,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14, 28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{2:15,4:77,6:3,7:[1,4],8:[1,5],9:6,10:[1,7],12:[1,11],13:[1,8],15:[1,9],21:[1,10],25:[1,12],26:[1,13],27:14,28:[1,18],30:[1,19],31:[1,20],34:[1,16],36:[1,17],38:[1,21]},{5:[2,24],11:[2,24],12:[2,24],14:[2,24],17:[2,24],18:[2,24],19:[2,24],20:[2,24],21:[2,24],22:[2,24],23:[2,24],24:[2,24],32:[2,24],33:[2,24]},{14:[1,78],32:[1,63],33:[1,64]},{39:[1,79]},{5:[2,41],11:[2,41],12:[2,41],14:[2,41],17:[2,41],18:[2,41],19:[2,41],20:[2,41],21:[2, 41],22:[2,41],23:[2,41],24:[2,41],32:[2,41],33:[2,41],37:[2,41]},{5:[2,30],11:[2,30],12:[2,30],14:[2,30],17:[2,30],18:[2,30],19:[2,30],20:[2,30],21:[2,30],22:[2,30],23:[2,30],24:[2,30],32:[2,30],33:[2,30]},{5:[2,32],11:[2,32],12:[2,32],14:[2,32],17:[2,32],18:[2,32],19:[2,32],20:[2,32],21:[2,32],22:[2,32],23:[2,32],24:[2,32],32:[2,32],33:[2,32]},{5:[2,33],11:[2,33],12:[2,33],14:[2,33],17:[2,33],18:[2,33],19:[2,33],20:[2,33],21:[2,33],22:[2,33],23:[2,33],24:[2,33],29:[1,80],32:[2,33],33:[2,33]},{5:[2, 43],11:[2,43],12:[2,43],14:[2,43],17:[2,43],18:[2,43],19:[2,43],20:[2,43],21:[2,43],22:[2,43],23:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43]},{5:[2,11],11:[2,11],12:[1,24],14:[2,11],17:[2,11],18:[2,11],19:[2,11],20:[2,11],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,11],33:[2,11]},{5:[2,13],11:[2,13],12:[1,24],14:[2,13],17:[2,13],18:[2,13],19:[2,13],20:[2,13],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,13],33:[2,13]},{5:[2,12],11:[2,12],12:[1,24],14:[2,12],17:[2,12],18:[2,12],19:[2, 12],20:[2,12],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,12],33:[2,12]},{11:[1,23],12:[1,24],14:[2,36],17:[2,36],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,36],33:[2,36]},{11:[1,23],12:[1,24],14:[2,37],17:[2,37],18:[1,25],19:[1,26],20:[1,27],21:[1,28],22:[1,29],23:[1,30],24:[1,31],32:[2,37],33:[2,37]},{5:[2,25],11:[2,25],12:[2,25],14:[2,25],17:[2,25],18:[2,25],19:[2,25],20:[2,25],21:[2,25],22:[2,25],23:[2,25],24:[2,25],32:[2,25],33:[2,25]},{5:[2,44],11:[2,44],12:[2, 44],14:[2,44],17:[2,44],18:[2,44],19:[2,44],20:[2,44],21:[2,44],22:[2,44],23:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],38:[2,44]},{30:[1,81]},{5:[2,34],11:[2,34],12:[2,34],14:[2,34],17:[2,34],18:[2,34],19:[2,34],20:[2,34],21:[2,34],22:[2,34],23:[2,34],24:[2,34],32:[2,34],33:[2,34]}],defaultActions:{22:[2,1]},parseError:function(a,b){if(b.recoverable)this.trace(a);else throw Error(a);},parse:function(a){function b(a){h.length-=2*a;l.length-=a;g.length-=a}function c(){var a;a=d.lexer.lex()||q; "number"!==typeof a&&(a=d.symbols_[a]||a);return a}var d=this,h=[0],l=[null],g=[],y=this.table,p="",n=0,s=0,r=0,q=1,v=g.slice.call(arguments,1);this.lexer.setInput(a);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var C=this.lexer.yylloc;g.push(C);var E=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"===typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var t, z,w,u,A={},D,x;;){w=h[h.length-1];if(this.defaultActions[w])u=this.defaultActions[w];else{if(null===t||"undefined"==typeof t)t=c();u=y[w]&&y[w][t]}if("undefined"===typeof u||!u.length||!u[0]){var B;u="";x=function(a){for(var b=h.length-1,c=0;;){if((2).toString()in y[a])return c;if(0===a||2>b)return!1;b-=2;a=h[b];++c}};if(r)z!==q&&(B=x(w));else{B=x(w);x=[];for(D in y[w])this.terminals_[D]&&2<D&&x.push("'"+this.terminals_[D]+"'");u=this.lexer.showPosition?"Parse error on line "+(n+1)+":\n"+this.lexer.showPosition()+ "\nExpecting "+x.join(", ")+", got '"+(this.terminals_[t]||t)+"'":"Parse error on line "+(n+1)+": Unexpected "+(t==q?"end of input":"'"+(this.terminals_[t]||t)+"'");this.parseError(u,{text:this.lexer.match,token:this.terminals_[t]||t,line:this.lexer.yylineno,loc:C,expected:x,recoverable:!1!==B})}if(3==r){if(t===q||z===q)throw Error(u||"Parsing halted while starting to recover from another error.");s=this.lexer.yyleng;p=this.lexer.yytext;n=this.lexer.yylineno;C=this.lexer.yylloc;t=c()}if(!1===B)throw Error(u|| "Parsing halted. No suitable error recovery rule available.");b(B);z=2==t?null:t;t=2;w=h[h.length-1];u=y[w]&&y[w][2];r=3}if(u[0]instanceof Array&&1<u.length)throw Error("Parse Error: multiple actions possible at state: "+w+", token: "+t);switch(u[0]){case 1:h.push(t);l.push(this.lexer.yytext);g.push(this.lexer.yylloc);h.push(u[1]);t=null;z?(t=z,z=null):(s=this.lexer.yyleng,p=this.lexer.yytext,n=this.lexer.yylineno,C=this.lexer.yylloc,0<r&&r--);break;case 2:x=this.productions_[u[1]][1];A.$=l[l.length- x];A._$={first_line:g[g.length-(x||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(x||1)].first_column,last_column:g[g.length-1].last_column};E&&(A._$.range=[g[g.length-(x||1)].range[0],g[g.length-1].range[1]]);w=this.performAction.apply(A,[p,s,n,this.yy,u[1],l,g].concat(v));if("undefined"!==typeof w)return w;x&&(h=h.slice(0,-2*x),l=l.slice(0,-1*x),g=g.slice(0,-1*x));h.push(this.productions_[u[1]][0]);l.push(A.$);g.push(A._$);w=y[h[h.length-2]][h[h.length-1]];h.push(w);break; case 3:return!0}}return!0}},d=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a);},setInput:function(a){this._input=a;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var a=this._input[0]; this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b-1);this.offset-=b;a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1); this.matched=this.matched.substr(0,this.matched.length-1);c.length-1&&(this.yylineno-=c.length-1);var d=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===a.length?this.yylloc.first_column:0)+a[a.length-c.length].length-c[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[d[0],d[0]+this.yyleng-b]);this.yyleng=this.yytext.length;return this},more:function(){this._more= !0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20< a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var c,d;this.options.backtrack_lexer&&(d={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column, last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(d.yylloc.range=this.yylloc.range.slice(0)));if(c=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c? c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._backtrack=this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];c=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(c)return c; if(this._backtrack)for(var h in d)this[h]=d[h];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c;this._more||(this.match=this.yytext="");for(var d=this._currentRules(),h=0;h<d.length;h++)if((b=this._input.match(this.rules[d[h]]))&&(!a||b[0].length>a[0].length))if(a=b,c=h,this.options.backtrack_lexer){a=this.test_match(b,d[h]);if(!1!==a)return a;if(this._backtrack)a=!1;else return!1}else if(!this.options.flex)break;return a?(a=this.test_match(a,d[c]),!1!== a?a:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]? this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(a){a=this.conditionStack.length-1-Math.abs(a||0);return 0<=a?this.conditionStack[a]:"INITIAL"},pushState:function(a){this.begin(a)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(b,c,d,g){switch(d){case 1:return 10;case 2:return 10;case 3:return 31;case 4:return 26;case 5:return 7;case 6:return 8;case 7:return"cell"==a.obj.type?31: 34;case 8:return"cell"==a.obj.type?28:34;case 9:return"cell"==a.obj.type?30:34;case 10:return 26;case 11:return 34;case 12:return 34;case 13:return 36;case 15:return" ";case 16:return 35;case 17:return 29;case 18:return 32;case 19:return 33;case 20:return 22;case 21:return 23;case 22:return 21;case 23:return 12;case 24:return 24;case 25:return 13;case 26:return 14;case 27:return 15;case 28:return 17;case 29:return 19;case 30:return 18;case 31:return 20;case 32:return"PI";case 33:return 25;case 34:return'"'; case 35:return"'";case 36:return"!";case 37:return 11;case 38:return 37;case 39:return 38;case 40:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:#[A-Za-z0-9_]+)/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:[A-Za-z0-9_]+>[A-Za-z0-9_]+)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/, /^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],inclusive:!0}}}}();c.lexer=d;b.prototype=c;c.Parser=b;return new b} function q(a,b){this.sheet=a;this.el="undefined"!=typeof b?n(b):!1;this.floatValue=this.computedValue=this.formattedValue=this.value=null;this.affected=!1;this.dependencies={};this.dependant={};this.conditionalStyle=!1;this.address="";this.init()}function s(a,b,c){this.identifier=a;this.el=n(b);this.lang="en";this.cells={};this.variables={};this.config=n.extend({},F,c);this.counter=1;this.init()}"function"!==typeof Array.indexOf&&(Array.prototype.indexOf=function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]== a)return c;return-1});"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(a){return a.__proto__}:function(a){return a.constructor.prototype});var F={autoCalculate:!0,autoCalculateTrigger:"blur",onBeforeCalculate:function(a){return a},onAfterCalculate:function(a){return a},onBeforeApply:function(a){return a},onAfterApply:function(a){return a}, precision:2,defaultFormat:!1,ajaxUrl:null,graphHandler:"flot"},g={custom:{},date:{DATE:function(a,b,c){return new Date(a,b-1,c)},DATEDIFF:function(a,b,c){return"undefined"==typeof moment?"#NAME?":moment(b).diff(moment.utc(a),c)},DATEFORMAT:function(a,b){return"undefined"==typeof moment?"#NAME?":moment(a).format(b)},DATEVALUE:function(a){return"undefined"==typeof moment?"#NAME?":Math.ceil((moment(a)-moment("1900-1-1"))/864E5)+2},DAY:function(a){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).date()}, DAYNAME:function(a){return v.DAY_NAME[g.date.WEEKDAY(a)-1]},DAYS:function(a,b){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).diff(moment(new Date(b)),"days")},DAYS360:function(a,b,c){if("undefined"==typeof moment)return"#NAME?";a=moment(new Date(a));b=moment(new Date(b));var d=31,e=31,f=a.date(),k=b.date();if(c)f=31===f?30:f,k=31===k?30:k;else if(1===a.month()&&(d=a.daysInMonth()),1===b.month()&&(e=b.daysInMonth()),f=f===d?30:f,30===f||f===d)k=k===e?30:k;return 360*(b.year()-a.year())+ 30*(b.month()-a.month())+(k-f)},EDATE:function(a,b){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).add("months",b).toDate()},EOMONTH:function(a,b){if("undefined"==typeof moment)return"#NAME?";var c=moment(new Date(a)).add("months",b);return new Date(c.year(),c.month(),c.daysInMonth())},FROMNOW:function(a,b){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).fromNow(b)},HOUR:function(a){return"undefined"==typeof moment?"#NAME?":1>=a?Math.floor(24*a):moment(new Date(a)).hours()}, MINUTE:function(a){return"undefined"==typeof moment?"#NAME?":1>=a?Math.floor(1440*a)-60*Math.floor(24*a):moment(new Date(a)).minutes()},ISOWEEKNUM:function(a){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).format("w")},MONTH:function(a){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).month()+1},NETWORKDAYS:function(a,b,c){return g.date.NETWORKDAYSINTL(a,b,1,c)},NETWORKDAYSINTL:function(a,b,c,d){if("undefined"==typeof moment)return"#NAME?";c=v.WEEKEND_TYPES["undefined"=== typeof c?1:c];var e=moment(a);a=b=moment(b).diff(e,"days")+1;var f="",k=[];if("undefined"!==typeof d)for(f=0;f<d.length;f++)k[f]=moment(new Date(d[f])).format("MM-DD-YYYY");for(d=0;d<b;)f=e.format("d"),0<=c.indexOf(parseInt(f,10))?a--:0<=k.indexOf(e.format("MM-DD-YYYY"))&&a--,e=e.add("days",1),d++;return a},NOW:function(){return new Date},SECOND:function(a){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).seconds()},TIME:function(a,b,c){return(3600*a+60*b+c)/86400},TIMEVALUE:function(a){if("undefined"== typeof moment)return"#NAME?";a=moment(new Date(a));return(3600*a.hours()+60*a.minutes()+a.seconds())/86400},TODAY:function(){return new Date},WEEKDAY:function(a,b){if("undefined"==typeof moment)return"#NAME?";var c=moment(new Date(a)).format("d");return v.WEEK_TYPES["undefined"===typeof b?1:b][c]},WEEKNUM:function(a,b){if("undefined"==typeof moment)return"#NAME?";var c=moment(new Date(a)),d=moment(new Date(c.year(),0,1)),e="undefined"===typeof b?1:b,f=v.WEEK_STARTS[e],k=d.format("d"),f=k<f?f-k+1: k-f;return 21===e?g.date.ISOWEEKNUM(a):Math.floor(c.diff(d.subtract("days",f),"days")/7)+1},WORKDAY:function(a,b,c){return g.date.WORKDAYINTL(a,b,1,c)},WORKDAYINTL:function(a,b,c,d){if("undefined"==typeof moment)return"#NAME?";c=WEEKEND_TYPES["undefined"===typeof c?1:c];a=moment(new Date(a));var e="",f=[];if("undefined"!==typeof d)for(e=0;e<d.length;e++)f[e]=moment(new Date(d[e])).format("MM-DD-YYYY");for(d=0;d<b;)a=a.add("days",1),e=a.format("d"),0>c.indexOf(parseInt(e,10))&&0>f.indexOf(a.format("MM-DD-YYYY"))&& d++;return a.toDate()},YEAR:function(a){return"undefined"==typeof moment?"#NAME?":moment(new Date(a)).year()},YEARFRAC:function(a,b,c){if("undefined"==typeof moment)return"#NAME?";c="undefined"===typeof c?0:c;var d=moment(new Date(a)),e=moment(new Date(b));if(!d.isValid()||!e.isValid())return"#VALUE!";if(-1===[0,1,2,3,4].indexOf(c))return"#NUM!";if(d===e)return 0;0<d.diff(e)&&(e=moment(new Date(a)),d=moment(new Date(b)));var f=d.year(),k=d.month(),g=d.date(),h=e.year();a=e.month();b=e.date();switch(c){case 0:return 31=== g&&31===b?b=g=30:31===g?g=30:30===g&&31===b?b=30:1===k&&1===a&&d.daysInMonth()===g&&e.daysInMonth()===b?b=g=30:1===k&&d.daysInMonth()===g&&(g=30),(b+30*a+360*h-(g+30*k+360*f))/360;case 1:c=365;if(f===h||f+1===h&&(k>a||k===a&&g>=b)){if(f===h&&moment([f]).isLeapYear())c=366;else if(f=d,h=e,k=moment(new Date(f.year(),2,1)),moment([f.year()]).isLeapYear()&&0>f.diff(k)&&0<=h.diff(k)?f=!0:(k=moment(new Date(h.year(),2,1)),f=moment([h.year()]).isLeapYear()&&0<=h.diff(k)&&0>f.diff(k)?!0:!1),f||1===a&&29=== b)c=366;return e.diff(d,"days")/c}a=h-f+1;a=moment(new Date(h+1,0,1)).diff(moment(new Date(f,0,1)),"days")/a;return e.diff(d,"days")/a;case 2:return e.diff(d,"days")/360;case 3:return e.diff(d,"days")/365;case 4:return 31===g&&(g=30),31===b&&(b=30),(b+30*a+360*h-(g+30*k+360*f))/360}}},math:{ABS:function(a){return Math.abs(a)},ACOS:function(a){return Math.acos(a)},ACOSH:function(a){return Math.log(a+Math.sqrt(a*a-1))},ACOT:function(a){return Math.atan(1/a)},ACOTH:function(a){return.5*Math.log((a+1)/ (a-1))},AGGREGATE:function(a,b){for(var c=[],d=2;d<arguments.length;d++)switch(a){case 1:c[d-2]=g.statistic.AVERAGE(arguments[d]);break;case 2:c[d-2]=g.statistic.COUNT(arguments[d]);break;case 3:c[d-2]=g.statistic.COUNTA(arguments[d]);break;case 4:c[d-2]=g.statistic.MAX(arguments[d]);break;case 5:c[d-2]=g.statistic.MIN(arguments[d]);break;case 6:c[d-2]=g.statistic.PRODUCT(arguments[d]);break;case 7:c[d-2]=g.statistic.STDEVS(arguments[d]);break;case 8:c[d-2]=g.statistic.STDEVP(arguments[d]);break; case 9:c[d-2]=g.math.SUM(arguments[d]);break;case 10:c[d-2]=g.statistic.VARS(arguments[d]);break;case 11:c[d-2]=g.statistic.VARP(arguments[d]);break;case 12:c[d-2]=g.statistic.MEDIAN(arguments[d]);break;case 13:c[d-2]=g.statistic.MODESNGL(arguments[d]);break;case 14:c[d-2]=g.statistic.LARGE(arguments[d]);break;case 15:c[d-2]=g.statistic.SMALL(arguments[d]);break;case 16:c[d-2]=g.statistic.PERCENTILEINC(arguments[d]);break;case 17:c[d-2]=g.statistic.QUARTILEINC(arguments[d]);break;case 18:c[d-2]=g.statistic.PERCENTILEEXC(arguments[d]); break;case 19:c[d-2]=g.statistic.QUARTILEEXC(arguments[d])}return c},ARABIC:function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return"#VALUE!";var b=0;a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){b+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]});return b},ASIN:function(a){return Math.asin(a)},ASINH:function(a){return Math.log(a+Math.sqrt(a*a+1))},ATAN:function(a){return Math.atan(a)},ATAN2:function(a,b){return Math.atan2(a, b)},ATANH:function(a){return Math.log((1+a)/(1-a))/2},BASE:function(a,b,c){c="undefined"===typeof c?0:c;a=a.toString(b);return Array(Math.max(c+1-a.length,0)).join("0")+a},CEILING:function(a,b,c){if(0===b)return 0;b="undefined"===typeof b?1:Math.abs(b);c="undefined"===typeof c?0:c;var d=-Math.floor(Math.log(b)/Math.log(10));return 0<=a?g.math.ROUND(Math.ceil(a/b)*b,d):0===c?-g.math.ROUND(Math.floor(Math.abs(a)/b)*b,d):-g.math.ROUND(Math.ceil(Math.abs(a)/b)*b,d)},CEILINGMATH:function(a,b,c){return g.math.CEILING(a, b,c)},CEILINGPRECISE:function(a,b,c){return g.math.CEILING(a,b,c)},COMBIN:function(a,b){return g.math.FACT(a)/(g.math.FACT(b)*g.math.FACT(a-b))},COMBINA:function(a,b){return 0===a&&0===b?1:g.math.COMBIN(a+b-1,a-1)},COS:function(a){return Math.cos(a)},COSH:function(a){return(Math.exp(a)+Math.exp(-a))/2},COT:function(a){return 1/Math.tan(a)},COTH:function(a){a=Math.exp(2*a);return(a+1)/(a-1)},CSC:function(a){return 1/Math.sin(a)},CSCH:function(a){return 2/(Math.exp(a)-Math.exp(-a))},DECIMAL:function(a, b){return parseInt(a,b)},DEGREES:function(a){return 180*a/Math.PI},EVEN:function(a){return g.math.CEILING(a,-2,-1)},EXP:function(a){return Math.exp(a)},FACT:function(a){a=Math.floor(a);if(0===a||1===a)return 1;0<v.MEMOIZED_FACT[a]||(v.MEMOIZED_FACT[a]=g.math.FACT(a-1)*a);return v.MEMOIZED_FACT[a]},FACTDOUBLE:function(a){a=Math.floor(a);return 0>=a?1:a*g.math.FACTDOUBLE(a-2)},FLOOR:function(a,b,c){if(0===b)return 0;b="undefined"===typeof b?1:Math.abs(b);c="undefined"===typeof c?0:c;var d=-Math.floor(Math.log(b)/ Math.log(10));return 0<=a?g.math.ROUND(Math.floor(a/b)*b,d):0===c?-g.math.ROUND(Math.ceil(Math.abs(a)/b)*b,d):-g.math.ROUND(Math.floor(Math.abs(a)/b)*b,d)},FLOORMATH:function(a,b,c){return g.math.FLOOR(a,b,c)},FLOORPRECISE:function(a,b,c){return g.math.FLOOR(a,b,c)},GCD:function(){for(var a,b,c=arguments.length-1,d=arguments[c];c;)for(b=arguments[--c];a=b%d;b=d,d=a);return d},INT:function(a){return Math.floor(a)},ISEVEN:function(a){return Math.floor(Math.abs(a))&1?!1:!0},ISOCEILING:function(a,b,c){return g.math.CEILING(a, b,c)},ISODD:function(a){return Math.floor(Math.abs(a))&1?!0:!1},LCM:function(){for(var a=p.toArray(arguments),b,c,d,e=1;void 0!==(d=a.pop());)for(;1<d;){if(d%2){b=3;for(c=Math.floor(Math.sqrt(d));b<=c&&d%b;b+=2);c=b<=c?b:d}else c=2;d/=c;e*=c;for(b=a.length;b;0===a[--b]%c&&1===(a[b]/=c)&&a.splice(b,1));}return e},LN:function(a){return Math.log(a)},LOG:function(a,b){b="undefined"===typeof b?10:b;return Math.log(a)/Math.log(b)},LOG10:function(a){return Math.log(a)/Math.log(10)},MOD:function(a,b){var c= Math.abs(a%b);return 0<b?c:-c},MROUND:function(a,b){if(0>a*b)throw Error("Number and multiple must have the same sign.");return Math.round(a/b)*b},MULTINOMIAL:function(){for(var a=0,b=1,c=0;c<arguments.length;c++)a+=arguments[c],b*=g.math.FACT(arguments[c]);return g.math.FACT(a)/b},ODD:function(a){var b=Math.ceil(Math.abs(a)),b=b&1?b:b+1;return 0<a?b:-b},PI:function(){return Math.PI},POWER:function(a,b){return Math.pow(a,b)},PRODUCT:function(){for(var a=1,b=0;b<arguments.length;b++)a*=arguments[b]; return a},QUOTIENT:function(a,b){return(a/b).toFixed(0)},RADIANS:function(a){return a*Math.PI/180},RAND:function(){return Math.random()},RANDBETWEEN:function(a,b){return a+Math.ceil((b-a+1)*Math.random())-1},ROUND:function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)},ROUNDDOWN:function(a,b){return(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)},ROUNDUP:function(a,b){return(0<a?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)},SERIESSUM:function(a,b,c,d){for(var e= d[0]*Math.pow(a,b),f=1;f<d.length;f++)e+=d[f]*Math.pow(a,b+f*c);return e},SEC:function(a){return 1/Math.cos(a)},SECH:function(a){return 2/(Math.exp(a)+Math.exp(-a))},SIGN:function(a){return 0>a?-1:0===a?0:1},SIN:function(a){return Math.sin(a)},SINH:function(a){return(Math.exp(a)-Math.exp(-a))/2},SQRT:function(a){return Math.sqrt(a)},SQRTPI:function(a){return Math.sqrt(a*Math.PI)},SUBTOTAL:function(a){for(var b=[],c=1;c<arguments.length;c++)switch(a){case 1:b[c-1]=g.statistic.AVERAGE(arguments[c]); break;case 2:b[c-1]=g.statistic.COUNT(arguments[c]);break;case 3:b[c-1]=g.statistic.COUNTA(arguments[c]);break;case 4:b[c-1]=g.statistic.MAX(arguments[c]);break;case 5:b[c-1]=g.statistic.MIN(arguments[c]);break;case 6:b[c-1]=g.statistic.PRODUCT(arguments[c]);break;case 7:b[c-1]=g.statistic.STDEV(arguments[c]);break;case 8:b[c-1]=g.statistic.STDEVP(arguments[c]);break;case 9:b[c-1]=g.math.SUM(arguments[c]);break;case 10:b[c-1]=g.statistic.VAR(arguments[c]);break;case 11:b[c-1]=g.statistic.VARP(arguments[c])}return b}, SUM:function(){var a,b,c,d="",e=0;for(b=0;b<arguments.length;b++)if("object"==typeof arguments[b])for(a in arguments[b])d+=arguments[b][a],c=isNaN(parseFloat(arguments[b][a],10))?0:parseFloat(arguments[b][a],10),e+=c;else d+=arguments[b][a],c=isNaN(parseFloat(arguments[b],10))?0:parseFloat(arguments[b],10),e+=c;return 0===e&&""===n.trim(d)?"":e},SUMIF:function(a,b){for(var c=0,d=0;d<a.length;d++)c+=eval(a[d]+b)?a[d]:0;return c},SUMIFS:function(){for(var a=(arguments.length-1)/2,b=arguments[0],c=0, d=0;d<b.length;d++){for(var e=!0,f=0;f<a;f++)eval(arguments[2*f+1][d]+arguments[2*f+2])||(e=!1);c+=e?b[d]:0}return c},SUMPRODUCT:function(){for(var a=arguments.length+1,b=0,c=0;c<arguments[0].length;c++)for(var d=0;d<arguments[0][c].length;d++){for(var e=1,f=1;f<a;f++)e*=arguments[f-1][c][d];b+=e}return b},SUMSQ:function(){for(var a=p.toArray(arguments),b=0,c=0;c<a.length;c++)b+=n.isNumeric(a[c])?a[c]*a[c]:0;return b},SUMX2MY2:function(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d]*a[d]-b[d]*b[d];return c}, SUMX2PY2:function(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d]*a[d]+b[d]*b[d];return c},SUMXMY2:function(a,b){for(var c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b[d],2);return c},TAN:function(a){return Math.tan(a)},TANH:function(a){a=Math.exp(2*a);return(a-1)/(a+1)},TRUNC:function(a,b){b="undefined"===typeof b?0:b;return(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)}},financial:{ACCRINT:function(a,b,c,d,e,f,k,m){if("undefined"==typeof moment)return"#NAME?";if(!moment(a).isValid()||!moment(b).isValid()|| !moment(c).isValid())return"#VALUE!";if(0>=d||0>=e||-1===[1,2,4].indexOf(f)||-1===[0,1,2,3,4].indexOf(k)||0<=moment(a).diff(moment(c)))return"#NUM!";e="undefined"===typeof e?0:e;k="undefined"===typeof k?0:k;f=0;m=moment(new Date(a));moment(new Date(b));moment(new Date(c));moment([m.year()]).isLeapYear();switch(k){case 0:f=g.date.YEARFRAC(a,c,k);break;case 1:f=g.date.YEARFRAC(a,c,k);break;case 2:f=g.date.YEARFRAC(a,c,k);break;case 3:f=g.date.YEARFRAC(a,c,k);break;case 4:f=g.date.YEARFRAC(a,c,k)}return e* d*f},ACCRINTM:function(){},AMORDEGRC:function(){},AMORLINC:function(){},COUPDAYBS:function(){},COUPDAYS:function(){},COUPDAYSNC:function(){},COUPNCD:function(){},COUPNUM:function(){},COUPPCD:function(){},CUMIPMT:function(a,b,c,d,e,f){if(0>=a||0>=b||0>=c||1>d||1>e||d>e||0!==f&&1!==f)return"#NUM!";b=g.financial.PMT(a,b,c,0,f);var k=0;1===d&&0===f&&(k=-c,d++);for(;d<=e;d++)k=1===f?k+(g.financial.FV(a,d-2,b,c,1)-b):k+g.financial.FV(a,d-1,b,c,0);return k*a},CUMPRINC:function(a,b,c,d,e,f){if(0>=a||0>=b|| 0>=c||1>d||1>e||d>e||0!==f&&1!==f)return"#NUM!";b=g.financial.PMT(a,b,c,0,f);var k=0;1===d&&(k=0===f?b+c*a:b,d++);for(;d<=e;d++)k=0<f?k+(b-(g.financial.FV(a,d-2,b,c,1)-b)*a):k+(b-g.financial.FV(a,d-1,b,c,0)*a);return k},DB:function(a,b,c,d,e){e="undefined"===typeof e?12:e;if(isNaN(a)||isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e))return"#VALUE!";if(0>a||0>b||0>c||0>d||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(e)||d>c)return"#NUM!";if(b>=a)return 0;b=(1-Math.pow(b/a,1/c)).toFixed(3);for(var f=e=a*b*e/12, k=0,g=d===c?c-1:d,h=2;h<=g;h++)k=(a-f)*b,f+=k;return 1===d?e:d===c?(a-f)*b:k},DDB:function(a,b,c,d,e){e="undefined"===typeof e?2:e;if(isNaN(a)||isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e))return"#VALUE!";if(0>a||0>b||0>c||0>d||0>=e||d>c)return"#NUM!";if(b>=a)return 0;for(var f=0,k=0,g=1;g<=d;g++)k=Math.min(e/c*(a-f),a-b-f),f+=k;return k},DISC:function(){},DOLLARDE:function(a,b){if(isNaN(a)||isNaN(b))return"#VALUE!";if(0>b)return"#NUM!";if(0<=b&&1>b)return"#DIV/0!";b=parseInt(b,10);var c=parseInt(a,10), c=c+a%1*Math.pow(10,Math.ceil(Math.log(b)/Math.LN10))/b,d=Math.pow(10,Math.ceil(Math.log(b)/Math.LN2)+1);return c=Math.round(c*d)/d},DOLLARFR:function(a,b){if(isNaN(a)||isNaN(b))return"#VALUE!";if(0>b)return"#NUM!";if(0<=b&&1>b)return"#DIV/0!";b=parseInt(b,10);var c=parseInt(a,10);return c+=a%1*Math.pow(10,-Math.ceil(Math.log(b)/Math.LN10))*b},DURATION:function(){},EFFECT:function(a,b){if(isNaN(a)||isNaN(b))return"#VALUE!";if(0>=a||1>b)return"#NUM!";b=parseInt(b,10);return Math.pow(1+a/b,b)-1},FV:function(a, b,c,d,e){e="undefined"===typeof e?0:e;0===a?a=d+c*b:(b=Math.pow(1+a,b),a=1===e?d*b+c*(1+a)*(b-1)/a:d*b+c*(b-1)/a);return-a},FVSCHEDULE:function(a,b){for(var c=a,d=0;d<b.length;d++){if(isNaN(b[d]))return"#VALUE!";c*=1+b[d]}return c},INTRATE:function(){},IPMT:function(a,b,c,d,e,f){f="undefined"===typeof f?0:f;c=g.financial.PMT(a,c,d,e,f);return(1===b?1===f?0:-d:1===f?g.financial.FV(a,b-2,c,d,1)-c:g.financial.FV(a,b-1,c,d,0))*a},IRR:function(a,b){var c=[],d;for(d in a)c.push(a[d]);d=function(a,b,c){c+= 1;for(var d=a[0],e=1;e<a.length;e++)d+=a[e]/Math.pow(c,(b[e]-b[0])/365);return d};for(var e=function(a,b,c){c+=1;for(var d=0,e=1;e<a.length;e++)var f=(b[e]-b[0])/365,d=d-f*a[e]/Math.pow(c,f+1);return d},f=[],k=!1,g=!1,h=0;h<c.length;h++)f[h]=0===h?0:f[h-1]+365,0<c[h]&&(k=!0),0>c[h]&&(g=!0);if(!k||!g)return"#NUM!";var k="undefined"===typeof b?.1:b,l,p,g=0,h=!0;do p=d(c,f,k),h=k-p/e(c,f,k),l=Math.abs(h-k),k=h,h=1E-10<l&&1E-10<Math.abs(p);while(h&&50>++g);return h?"#NUM!":k},ISPMT:function(a,b,c,d){return d* a*(b/c-1)},MDURATION:function(){},MIRR:function(a,b,c){for(var d=a.length,e=[],f=[],k=0;k<d;k++)0>a[k]?e.push(a[k]):f.push(a[k]);a=-g.financial.NPV(c,f)*Math.pow(1+c,d-1);b=g.financial.NPV(b,e)*(1+b);return Math.pow(a/b,1/(d-1))-1},NOMINAL:function(a,b){if(isNaN(a)||isNaN(b))return"#VALUE!";if(0>=a||1>b)return"#NUM!";b=parseInt(b,10);return(Math.pow(a+1,1/b)-1)*b},NPER:function(a,b,c,d,e){e="undefined"===typeof e?0:e;return Math.log((b*(1+a*e)-("undefined"===typeof d?0:d)*a)/(c*a+b*(1+a*e)))/Math.log(1+ a)},NPV:function(){for(var a=[],b=0;b<arguments.length;b++)if("object"==typeof arguments[b])for(var c in arguments[b])a=a.concat(parseFloat(arguments[b][c],10));else a=a.concat(parseFloat(arguments[b],10));b=a[0];c=0;for(var d=1;d<a.length;d++)c+=a[d]/Math.pow(1+b,d);return c},ODDFPRICE:function(){},ODDFYIELD:function(){},ODDLPRICE:function(){},ODDLYIELD:function(){},PDURATION:function(a,b,c){return isNaN(a)||isNaN(b)||isNaN(c)?"#VALUE!":0>=a?"#NUM!":(Math.log(c)-Math.log(b))/Math.log(1+a)},PMT:function(a, b,c,d,e){e="undefined"===typeof e?0:e;0===a?a=(c+d)/b:(b=Math.pow(1+a,b),a=1===e?(d*a/(b-1)+c*a/(1-1/b))/(1+a):d*a/(b-1)+c*a/(1-1/b));return-a},PPMT:function(a,b,c,d,e,f){return g.financial.PMT(a,c,d,e,f)-g.financial.IPMT(a,b,c,d,e,f)},PRICE:function(){},PRICEDISC:function(){},PRICEMAT:function(){},PV:function(a,b,c,d,e){e="undefined"===typeof e?0:e;return 0===a?-c*b-d:((1-Math.pow(1+a,b))/a*c*(1+a*e)-d)/Math.pow(1+a,b)},RATE:function(a,b,c,d,e,f){d="undefined"===typeof d?0:d;e="undefined"===typeof e? 0:e;var k,g,h,l=0,p=k=0,n="undefined"===typeof f?.01:f;1E-10>Math.abs(n)||(k=Math.exp(a*Math.log(1+n)));f=c+b*a+d;g=c*k+b*(1/n+e)*(k-1)+d;p=h=0;for(l=n;1E-10<Math.abs(f-g)&&50>p;)n=(g*h-f*l)/(g-f),h=l,l=n,1E-10>Math.abs(n)?k=c*(1+a*n)+b*(1+n*e)*a+d:(k=Math.exp(a*Math.log(1+n)),k=c*k+b*(1/n+e)*(k-1)+d),f=g,g=k,++p;return n},RECEIVED:function(){},RRI:function(a,b,c){return isNaN(a)||isNaN(b)||isNaN(c)?"#VALUE!":0===a||0===b?"#NUM!":Math.pow(c/b,1/a)-1},SLN:function(a,b,c){return isNaN(a)||isNaN(b)|| isNaN(c)?"#VALUE!":0===c?"#NUM!":(a-b)/c},SYD:function(a,b,c,d){if(isNaN(a)||isNaN(b)||isNaN(c)||isNaN(d))return"#VALUE!";if(0===c||1>d||d>c)return"#NUM!";d=parseInt(d,10);return(a-b)*(c-d+1)*2/(c*(c+1))},TBILLEQ:function(a,b,c){return moment(a).isValid()&&moment(b).isValid()?0>=c||0<moment(a).diff(moment(b))||1<moment(b).diff(moment(a),"years")?"#NUM!":365*c/(360-c*g.date.DAYS360(a,b)):"#VALUE!"},TBILLPRICE:function(a,b,c){return moment(a).isValid()&&moment(b).isValid()?0>=c||0<moment(a).diff(moment(b))|| 1<moment(b).diff(moment(a),"years")?"#NUM!":100*(1-c*g.date.DAYS360(a,b)/360):"#VALUE!"},TBILLYIELD:function(a,b,c){return moment(a).isValid()&&moment(b).isValid()?0>=c||0<moment(a).diff(moment(b))||1<moment(b).diff(moment(a),"years")?"#NUM!":360*(100-c)/(c*g.date.DAYS360(a,b)):"#VALUE!"},VDB:function(){},XIRR:function(a,b,c){for(var d=function(a,b,c){c+=1;for(var d=a[0],e=1;e<a.length;e++)d+=a[e]/Math.pow(c,moment(b[e]).diff(moment(b[0]),"days")/365);return d},e=function(a,b,c){c+=1;for(var d=0, e=1;e<a.length;e++)var f=moment(b[e]).diff(moment(b[0]),"days")/365,d=d-f*a[e]/Math.pow(c,f+1);return d},f=!1,k=!1,g=0;g<a.length;g++)0<a[g]&&(f=!0),0>a[g]&&(k=!0);if(!f||!k)return"#NUM!";c=c||.1;var h,f=0,k=!0;do h=d(a,b,c),k=c-h/e(a,b,c),g=Math.abs(k-c),c=k,k=1E-10<g&&1E-10<Math.abs(h);while(k&&50>++f);return k?"#NUM!":c},XNPV:function(a,b,c){for(var d=0,e=0;e<b.length;e++)d+=b[e]/Math.pow(1+a,moment(c[e]).diff(moment(c[0]),"days")/365);return d},YIELD:function(){},YIELDDISC:function(){},YIELDMAT:function(){}}, statistic:{AVEDEV:function(){if("undefined"==typeof jStat)return"#NAME?";var a=p.arrayMerge(arguments);return jStat.sum(jStat(a).subtract(jStat.mean(a)).abs()[0])/a.length},AVERAGE:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=0,e=0,f=0;f<b;f++)!0!==a[f]&&!1!==a[f]&&(e=parseFloat(a[f]),d+=isNaN(e)?0:e,c++);return d/c},AVERAGEA:function(){return"undefined"==typeof jStat?"#NAME?":jStat.mean(p.arrayMerge(arguments))},AVERAGEIF:function(a,b,c){c="undefined"===typeof c?a:c;for(var d=0, e=0,f=0;f<a.length;f++)eval(a[f]+b)&&(e+=c[f],d++);return e/d},AVERAGEIFS:function(){for(var a=(arguments.length-1)/2,b=arguments[0],c=0,d=0,e=0;e<b.length;e++){for(var f=!0,k=0;k<a;k++)eval(arguments[2*k+1][e]+arguments[2*k+2])||(f=!1);f&&(d+=b[e],c++)}return d/c},BETADIST:function(a,b,c,d,e,f){if("undefined"==typeof jStat)return"#NAME?";e="undefined"===typeof e?0:e;a=(a-e)/(("undefined"===typeof f?1:f)-e);return d?jStat.beta.cdf(a,b,c):jStat.beta.pdf(a,b,c)},BETAINV:function(a,b,c,d,e){if("undefined"== typeof jStat)return"#NAME?";d="undefined"===typeof d?0:d;e="undefined"===typeof e?1:e;return jStat.beta.inv(a,b,c)*(e-d)+d},BINOMDIST:function(a,b,c,d){return"undefined"==typeof jStat?"#NAME?":d?jStat.binomial.cdf(a,b,c):jStat.binomial.pdf(a,b,c)},BINOMDISTRANGE:function(a,b,c,d){d="undefined"===typeof d?c:d;for(var e=0;c<=d;c++)e+=g.math.COMBIN(a,c)*Math.pow(b,c)*Math.pow(1-b,a-c);return e},BINOMINV:function(a,b,c){if("undefined"==typeof jStat)return"#NAME?";for(var d=0;d<=a;){if(jStat.binomial.cdf(d, a,b)>=c)return d;d++}},CHISQDIST:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":c?jStat.chisquare.cdf(a,b):jStat.chisquare.pdf(a,b)},CHISQDISTRT:function(a,b){},CHISQINV:function(a,b){return"undefined"==typeof jStat?"#NAME?":jStat.chisquare.inv(a,b)},CHISQINVRT:function(){},CHISQTEST:function(){},CONFIDENCENORM:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":jStat.normalci(1,a,b,c)[1]-1},CONFIDENCET:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":jStat.tci(1,a,b,c)[1]- 1},CORREL:function(){return"undefined"==typeof jStat?"#NAME?":jStat.corrcoeff.apply(this,arguments)},COUNT:function(){return p.arrayMerge(arguments).length},COUNTA:function(){var a=p.arrayMerge(arguments);return a.length-g.statistic.COUNTBLANK(a)},COUNTBLANK:function(){for(var a=p.arrayMerge(arguments),b=0,c=0;c<a.length;c++)null!==a[c]&&""!==a[c]||b++;return b},COUNTIF:function(a,b){for(var c=0,d=0;d<a.length;d++)a[d].match(new RegExp(b))&&c++;return c},COUNTIFS:function(){for(var a=(arguments.length- 1)/2,b=arguments[0],c=0,d=0;d<b.length;d++){for(var e=!0,f=0;f<a;f++)eval(arguments[2*f+1][d]+arguments[2*f+2])||(e=!1);c+=e?1:0}return c},COUNTUNIQUE:function(){return p.unique(p.arrayMerge(arguments)).length},COVARIANCEP:function(a,b){if("undefined"==typeof jStat)return"#NAME?";for(var c=jStat.mean(a),d=jStat.mean(b),e=0,f=a.length,k=0;k<f;k++)e+=(a[k]-c)*(b[k]-d);return e/f},COVARIANCES:function(){return"undefined"==typeof jStat?"#NAME?":jStat.covariance.apply(this,arguments)},DEVSQ:function(){if("undefined"== typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments),b=jStat.mean(a),c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b,2);return c},EXPONDIST:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":c?jStat.exponential.cdf(a,b):jStat.exponential.pdf(a,b)},FDIST:function(a,b,c,d){return"undefined"==typeof jStat?"#NAME?":d?jStat.centralF.cdf(a,b,c):jStat.centralF.pdf(a,b,c)},FDISTRT:function(){},FINV:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":jStat.centralF.inv(a,b,c)},FINVRT:function(){}, FTEST:function(){},FISHER:function(a){return Math.log((1+a)/(1-a))/2},FISHERINV:function(a){a=Math.exp(2*a);return(a-1)/(a+1)},FORECAST:function(a,b,c){if("undefined"==typeof jStat)return"#NAME?";for(var d=jStat.mean(c),e=jStat.mean(b),f=c.length,k=0,g=0,h=0;h<f;h++)k+=(c[h]-d)*(b[h]-e),g+=Math.pow(c[h]-d,2);b=k/g;return e-b*d+b*a},FREQUENCY:function(a,b){for(var c=a.length,d=b.length,e=[],f=0;f<=d;f++)for(var k=e[f]=0;k<c;k++)0===f?a[k]<=b[0]&&(e[0]+=1):f<d?a[k]>b[f-1]&&a[k]<=b[f]&&(e[f]+=1):f=== d&&a[k]>b[d-1]&&(e[d]+=1);return e},GAMMA:function(){return"undefined"==typeof jStat?"#NAME?":jStat.gammafn.apply(this,arguments)},GAMMADIST:function(a,b,c,d){},GAMMAINV:function(a,b,c){},GAMMALN:function(){return"undefined"==typeof jStat?"#NAME?":jStat.gammaln.apply(this,arguments)},GAMMALNPRECISE:function(){},GAUSS:function(a){return"undefined"==typeof jStat?"#NAME?":jStat.normal.cdf(a,0,1)-.5},GEOMEAN:function(){return"undefined"==typeof jStat?"#NAME?":jStat.geomean(p.arrayMerge(arguments))},GROWTH:function(a, b,c,d){var e;if("undefined"===typeof b)for(b=[],e=1;e<=a.length;e++)b.push(e);if("undefined"===typeof c)for(c=[],e=1;e<=a.length;e++)c.push(e);"undefined"===typeof d&&(d=!0);var f=a.length,k=0,g=0,h=0,l=0;for(e=0;e<f;e++)var n=b[e],p=Math.log(a[e]),k=k+n,g=g+p,h=h+n*p,l=l+n*n;k/=f;g/=f;h/=f;l/=f;d?(a=(h-k*g)/(l-k*k),k=g-a*k):(a=h/l,k=0);g=[];for(e=0;e<c.length;e++)g.push(Math.exp(k+a*c[e]));return g},HARMEAN:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=0;d<b;d++)c+=1/a[d];return b/ c},HYPGEOMDIST:function(a,b,c,d,e){function f(a,b,c,d){return g.math.COMBIN(c,a)*g.math.COMBIN(d-c,b-a)/g.math.COMBIN(d,b)}function k(a,b,c,d){for(var e=0,g=0;g<=a;g++)e+=f(g,b,c,d);return e}return e?k(a,b,c,d):f(a,b,c,d)},INTERCEPT:function(a,b){return g.statistic.FORECAST(0,a,b)},KURT:function(){if("undefined"==typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments),b=jStat.mean(a),c=a.length,d=0,e=0;e<c;e++)d+=Math.pow(a[e]-b,4);d/=Math.pow(jStat.stdev(a,!0),4);return c*(c+1)/((c-1)*(c-2)* (c-3))*d-3*(c-1)*(c-1)/((c-2)*(c-3))},LARGE:function(a,b){return a.sort(function(a,b){return b-a})[b-1]},LINEST:function(a,b){if("undefined"==typeof jStat)return"#NAME?";for(var c=jStat.mean(b),d=jStat.mean(a),e=b.length,f=0,g=0,m=0;m<e;m++)f+=(b[m]-c)*(a[m]-d),g+=Math.pow(b[m]-c,2);e=f/g;return[e,d-e*c]},LOGEST:function(){},LOGNORMDIST:function(a,b,c,d){return"undefined"==typeof jStat?"#NAME?":d?jStat.lognormal.cdf(a,b,c):jStat.lognormal.pdf(a,b,c)},LOGNORMINV:function(a,b,c){return"undefined"== typeof jStat?"#NAME?":jStat.lognormal.inv(a,b,c)},MAX:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0<b?a[0]:0,d=0;d<b;d++)c=a[d]>c&&!0!==a[d]&&!1!==a[d]?a[d]:c;return c},MAXA:function(){var a=p.arrayMerge(arguments);return 0<a.length?Math.max.apply(Math,a):0},MEDIAN:function(){return"undefined"==typeof jStat?"#NAME?":jStat.median(p.arrayMerge(arguments))},MIN:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0<b?a[0]:0,d=0;d<b;d++)c=a[d]<c&&!0!==a[d]&&!1!==a[d]?a[d]:c;return c}, MINA:function(){var a=p.arrayMerge(arguments);return 0<a.length?Math.min.apply(Math,a):0},MODEMULT:function(){for(var a=p.arrayMerge(arguments),b=a.length,c={},d=[],e=0,f,g=0;g<b;g++)f=a[g],c[f]=c[f]?c[f]+1:1,c[f]>e&&(e=c[f],d=[]),c[f]===e&&(d[d.length]=f);return d},MODESNGL:function(){return g.statistic.MODEMULT(p.arrayMerge(arguments)).sort(function(a,b){return a-b})[0]},NEGBINOMDIST:function(a,b,c,d){return"undefined"==typeof jStat?"#NAME?":d?jStat.negbin.cdf(a,b,c):jStat.negbin.pdf(a,b,c)},NORMDIST:function(a, b,c,d){return"undefined"==typeof jStat?"#NAME?":isNaN(a)||isNaN(b)||isNaN(c)?"#VALUE!":0>=c?"#NUM!":d?jStat.normal.cdf(a,b,c):jStat.normal.pdf(a,b,c)},NORMINV:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":jStat.normal.inv(a,b,c)},NORMSDIST:function(a,b){return"undefined"==typeof jStat?"#NAME?":b?jStat.normal.cdf(a,0,1):jStat.normal.pdf(a,0,1)},NORMSINV:function(a){return"undefined"==typeof jStat?"#NAME?":jStat.normal.inv(a,0,1)},PEARSON:function(a,b){if("undefined"==typeof jStat)return"#NAME?"; for(var c=jStat.mean(a),d=jStat.mean(b),e=a.length,f=0,g=0,m=0,h=0;h<e;h++)f+=(a[h]-c)*(b[h]-d),g+=Math.pow(a[h]-c,2),m+=Math.pow(b[h]-d,2);return f/Math.sqrt(g*m)},PERCENTILEEXC:function(a,b){a=a.sort(function(a,b){return a-b});var c=a.length;if(b<1/(c+1)||b>1-1/(c+1))return"#NUM!";var c=b*(c+1)-1,d=Math.floor(c);return p.cleanFloat(c===d?a[c]:a[d]+(c-d)*(a[d+1]-a[d]))},PERCENTILEINC:function(a,b){a=a.sort(function(a,b){return a-b});var c=b*(a.length-1),d=Math.floor(c);return p.cleanFloat(c===d? a[c]:a[d]+(c-d)*(a[d+1]-a[d]))},PERCENTRANKEXC:function(a,b,c){a=a.sort(function(a,b){return a-b});var d=_.uniq(a),e=a.length,f=d.length;c=Math.pow(10,"undefined"===typeof c?3:c);for(var g=0,m=!1,h=0;!m&&h<f;)b===d[h]?(g=(a.indexOf(d[h])+1)/(e+1),m=!0):b>=d[h]&&(b<d[h+1]||h===f-1)&&(g=(a.indexOf(d[h])+1+(b-d[h])/(d[h+1]-d[h]))/(e+1),m=!0),h++;return Math.floor(g*c)/c},PERCENTRANKINC:function(a,b,c){a=a.sort(function(a,b){return a-b});var d=_.uniq(a),e=a.length,f=d.length;c=Math.pow(10,"undefined"=== typeof c?3:c);for(var g=0,m=!1,h=0;!m&&h<f;)b===d[h]?(g=a.indexOf(d[h])/(e-1),m=!0):b>=d[h]&&(b<d[h+1]||h===f-1)&&(g=(a.indexOf(d[h])+(b-d[h])/(d[h+1]-d[h]))/(e-1),m=!0),h++;return Math.floor(g*c)/c},PERMUT:function(a,b){return g.math.FACT(a)/g.math.FACT(a-b)},PERMUTATIONA:function(a,b){return Math.pow(a,b)},PHI:function(a){return Math.exp(-.5*a*a)/SQRT2PI},POISSONDIST:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":c?jStat.poisson.cdf(a,b):jStat.poisson.pdf(a,b)},PROB:function(a,b,c,d){if("undefined"=== typeof c)return 0;d="undefined"===typeof d?c:d;if(c===d)return 0<=a.indexOf(c)?b[a.indexOf(c)]:0;for(var e=a.sort(function(a,b){return a-b}),f=e.length,g=0,m=0;m<f;m++)e[m]>=c&&e[m]<=d&&(g+=b[a.indexOf(e[m])]);return g},QUARTILEEXC:function(a,b){switch(b){case 1:return g.statistic.PERCENTILEEXC(a,.25);case 2:return g.statistic.PERCENTILEEXC(a,.5);case 3:return g.statistic.PERCENTILEEXC(a,.75);default:return"#NUM!"}},QUARTILEINC:function(a,b){switch(b){case 1:return g.statistic.PERCENTILEINC(a,.25); case 2:return g.statistic.PERCENTILEINC(a,.5);case 3:return g.statistic.PERCENTILEINC(a,.75);default:return"#NUM!"}},RANKAVG:function(a,b,c){b=b.sort(("undefined"===typeof c?0:c)?function(a,b){return a-b}:function(a,b){return b-a});c=p.countIn(b,a);return 1<c?(2*b.indexOf(a)+c+1)/2:b.indexOf(a)+1},RANKEQ:function(a,b,c){b=b.sort(("undefined"===typeof c?0:c)?function(a,b){return a-b}:function(a,b){return b-a});return b.indexOf(a)+1},RSQ:function(a,b){return Math.pow(g.statistic.PEARSON(a,b),2)},SKEW:function(){if("undefined"== typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments),b=jStat.mean(a),c=a.length,d=0,e=0;e<c;e++)d+=Math.pow(a[e]-b,3);return c*d/((c-1)*(c-2)*Math.pow(jStat.stdev(a,!0),3))},SKEWP:function(){if("undefined"==typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments),b=jStat.mean(a),c=a.length,d=0,e=0,f=0;f<c;f++)e+=Math.pow(a[f]-b,3),d+=Math.pow(a[f]-b,2);return e/c/Math.pow(d/c,1.5)},SLOPE:function(a,b){if("undefined"==typeof jStat)return"#NAME?";for(var c=jStat.mean(b),d=jStat.mean(a), e=b.length,f=0,g=0,m=0;m<e;m++)f+=(b[m]-c)*(a[m]-d),g+=Math.pow(b[m]-c,2);return f/g},SMALL:function(a,b){return a.sort(function(a,b){return a-b})[b-1]},STANDARDIZE:function(a,b,c){return(a-b)/c},STDEVA:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=jStat.mean(a),e=0;e<b;e++)c+=Math.pow(a[e]-d,2);return Math.sqrt(c/(b-1))},STDEVP:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=0,e=g.statistic.AVERAGE(a),f=0;f<b;f++)!0!==a[f]&&!1!==a[f]&&(c+=Math.pow(a[f]-e,2),d++);return Math.sqrt(c/ d)},STDEVPA:function(){if("undefined"==typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=jStat.mean(a),e=0;e<b;e++)c+=Math.pow(a[e]-d,2);return Math.sqrt(c/b)},STDEVS:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=0,e=g.statistic.AVERAGE(a),f=0;f<b;f++)!0!==a[f]&&!1!==a[f]&&(c+=Math.pow(a[f]-e,2),d++);return Math.sqrt(c/(d-1))},STEYX:function(a,b){if("undefined"==typeof jStat)return"#NAME?";for(var c=jStat.mean(b),d=jStat.mean(a),e=b.length,f=0,g=0,m=0, h=0;h<e;h++)f+=Math.pow(a[h]-d,2),g+=(b[h]-c)*(a[h]-d),m+=Math.pow(b[h]-c,2);return Math.sqrt((f-g*g/m)/(e-2))},TDIST:function(a,b,c){return"undefined"==typeof jStat?"#NAME?":c?jStat.studentt.cdf(a,b):jStat.studentt.pdf(a,b)},TDIST2T:function(){},TDISTRT:function(){},TINV:function(a,b){return"undefined"==typeof jStat?"#NAME?":jStat.studentt.inv(a,b)},TINV2T:function(){},TTEST:function(){},TREND:function(){},TRIMMEAN:function(a,b){if("undefined"==typeof jStat)return"#NAME?";var c=g.math.FLOOR(a.length* b,2)/2;return jStat.mean(_.initial(_.rest(a.sort(function(a,b){return a-b}),c),c))},VARA:function(){if("undefined"==typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=jStat.mean(a),e=0;e<b;e++)c+=Math.pow(a[e]-d,2);return c/(b-1)},VARP:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=0,e=g.statistic.AVERAGE(a),f=0;f<b;f++)!0!==a[f]&&!1!==a[f]&&(c+=Math.pow(a[f]-e,2),d++);return c/d},VARPA:function(){if("undefined"==typeof jStat)return"#NAME?";for(var a=p.arrayMerge(arguments), b=a.length,c=0,d=jStat.mean(a),e=0;e<b;e++)c+=Math.pow(a[e]-d,2);return c/b},VARS:function(){for(var a=p.arrayMerge(arguments),b=a.length,c=0,d=0,e=g.statistic.AVERAGE(a),f=0;f<b;f++)!0!==a[f]&&!1!==a[f]&&(c+=Math.pow(a[f]-e,2),d++);return c/(d-1)},WEIBULLDIST:function(a,b,c,d){return d?1-Math.exp(-Math.pow(a/c,b)):Math.pow(a,b-1)*Math.exp(-Math.pow(a/c,b))*b/Math.pow(c,b)},ZTEST:function(a,b,c){var d=a.length;c="undefined"===typeof c?g.statistic.STDEVS(a):c;return 1-g.statistic.NORMSDIST((g.statistic.AVERAGE(a)- b)/(c/Math.sqrt(d)),g.logical.TRUE)}},logical:{AND:function(){for(var a=!0,b=0;b<arguments.length;b++)arguments[b]||(a=!1);return a},FALSE:function(){return!1},IF:function(a,b,c){return a?"undefined"===typeof b?!0:b:"undefined"===typeof c?!0:c},IFERROR:function(a,b){return 0<=v.ERROR.indexOf(a)?b:a},IFNA:function(a,b){return"#N/A"===a?b:a},NOT:function(a){return!a},OR:function(){for(var a=!1,b=0;b<arguments.length;b++)arguments[b]&&(a=!0);return a},SWITCH:function(){var a;if(0<arguments.length){var b= arguments[0],c=arguments.length-1,d=Math.floor(c/2),e=!1,c=0===c%2?null:arguments[arguments.length-1];if(d)for(var f=0;f<d;f++)if(b==arguments[2*f+1]){a=arguments[2*f+2];e=!0;break}!e&&c&&(a=c)}return a},TRUE:function(){return!0},XOR:function(){for(var a=0,b=0;b<arguments.length;b++)arguments[b]&&a++;return Math.floor(Math.abs(a))&1?!0:!1}},geometry:{},text:{CONCAT:function(){var a="",b;for(b in arguments)a="object"==typeof arguments[b]?a+g.text.CONCAT.apply(this,arguments[b]):a+arguments[b];return a}, CHAR:function(a){return String.fromCharCode(a)},CLEAN:function(a){return a.replace(/[\0-\x1F]/g,"")},CODE:function(a){return a.charCodeAt(0)},CONCATENATE:function(){for(var a="",b=0;b<arguments.length;b++)null!==arguments[b]&&void 0!==arguments[b]&&(a+=arguments[b]);return a},DOLLAR:function(a,b){if("undefined"==typeof numeral)return"#NAME?";b="undefined"===typeof b?2:b;var c="";0>=b?(a=Math.round(a*Math.pow(10,b))/Math.pow(10,b),c="($0,0)"):0<b&&(c="($0,0."+Array(b+1).join("0")+")");return numeral(a).format(c)}, EXACT:function(a,b){return a===b},FIND:function(a,b,c){return b?b.indexOf(a,("undefined"===typeof c?0:c)-1)+1:null},FIXED:function(a,b,c){if("undefined"==typeof numeral)return"#NAME?";b="undefined"===typeof b?2:b;c=("undefined"===typeof c?0:c)?"0":"0,0";0>=b?a=Math.round(a*Math.pow(10,b))/Math.pow(10,b):0<b&&(c+="."+Array(b+1).join("0"));return numeral(a).format(c)},HTML2TEXT:function(a){var b="";a&&(a instanceof Array?a.forEach(function(a){""!==b&&(b+="\n");b+=a.replace(/<(?:.|\n)*?>/gm,"")}):b= a.replace(/<(?:.|\n)*?>/gm,""));return b},HUMANIZE:function(a){return a instanceof Date?(a=moment(a),a.hours()||a.minutes()||a.seconds()?a.format("dddd, MMMM Do YYYY, h:mm:ss"):a.format("dddd, MMMM Do YYYY")):a},JOIN:function(a,b){return a.join(b)},LEFT:function(a,b){return a?a.substring(0,"undefined"===typeof b?1:b):null},LEN:function(a){return a?a.length:0},LOWER:function(a){return a?a.toLowerCase():a},MID:function(a,b,c){return a.substring(b-1,c)},NUMBERVALUE:function(a,b,c){c="undefined"===typeof c? ",":c;return Number(a.replace("undefined"===typeof b?".":b,".").replace(c,""))},PROPER:function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},REGEXEXTRACT:function(a,b){var c=a.match(new RegExp(b));return c?c[0]:null},REGEXMATCH:function(a,b,c){var d=a.match(new RegExp(b));return c?d:a.match(new RegExp(b))?!0:!1},REGEXREPLACE:function(a,b,c){return a.replace(new RegExp(b),c)},REPLACE:function(a,b,c,d){return a.substr(0,b-1)+d+a.substr(b-1+c)}, REPT:function(a,b){return Array(b+1).join(a)},RIGHT:function(a,b){return a?a.substring(a.length-("undefined"===typeof b?1:b)):null},ROMAN:function(a){a=String(a).split("");for(var b=" C CC CCC CD D DC DCC DCCC CM X XX XXX XL L LX LXX LXXX XC I II III IV V VI VII VIII IX".split(" "),c="",d=3;d--;)c=(b[+a.pop()+10*d]||"")+c;return Array(+a.join("")+1).join("M")+c},SEARCH:function(a,b,c){c="undefined"===typeof c?0:c;return b.toLowerCase().indexOf(a.toLowerCase(),c-1)+1},SPLIT:function(a,b){a=n.trim(a); return a.split(a,delimiter||/\s+/)},SUBSTITUTE:function(a,b,c,d){if(a&&b&&c){if("undefined"===typeof d)return a.replace(new RegExp(b,"g"),c);for(var e=0,f=0;0<a.indexOf(b,e);)if(e=a.indexOf(b,e+1),f++,f===d)return a.substring(0,e)+c+a.substring(e+b.length)}else return a},T:function(a){return"string"===typeof a?a:null},TEXT:function(a,b){if("undefined"==typeof numeral)return"#NAME?";var c="";if(a)if(a instanceof Object)try{c=JSON.stringify(a)}catch(d){}else"string"===typeof a?c=b?0<=b.indexOf("0")? numeral(a).format(b):moment(new Date(a)).format(b):a:a.toString&&"function"===typeof a.toString&&(c=a.toString());return c},TRIM:function(a){return n.trim(a)},UNICHAR:function(a){return g.text.CHAR(a)},UNICODE:function(a){return g.text.CODE(a)},UPPER:function(a){return a.toUpperCase()},VALUE:function(a){return"undefined"==typeof numeral?"#NAME?":numeral().unformat(a)}},trigonometry:{},general:{VLOOKUP:function(a,b,c){},HLOOKUP:function(a,b,c){}},engineering:{BIN2DEC:function(a){if(!p.isValidBinary(a))return"#NUM!"; var b=parseInt(a,2);a=a.toString();return 10===a.length&&"1"===a.substring(0,1)?parseInt(a.substring(1),2)-512:b},BIN2HEX:function(a,b){if(!p.isValidBinary(a))return"#NUM!";var c=a.toString();if(10===c.length&&"1"===c.substring(0,1))return(0xfffffffe00+parseInt(c.substring(1),2)).toString(16);c=parseInt(a,2).toString(16);if("undefined"===typeof b)return c;if(isNaN(b))return"#VALUE!";if(0>b)return"#NUM!";b=Math.floor(b);return b>=c.length?p.repeat("0",b-c.length)+c:"#NUM!"},BIN2OCT:function(a,b){if(!p.isValidBinary(a))return"#NUM!"; var c=a.toString();if(10===c.length&&"1"===c.substring(0,1))return(1073741312+parseInt(c.substring(1),2)).toString(8);c=parseInt(a,2).toString(8);if("undefined"===typeof b)return c;if(isNaN(b))return"#VALUE!";if(0>b)return"#NUM!";b=Math.floor(b);return b>=c.length?p.repeat("0",b-c.length)+c:"#NUM!"},BITAND:function(a,b){a=parseFloat(a,10);b=parseFloat(b,10);return isNaN(a)||isNaN(b)?"#VALUE!":0>a||0>b||Math.floor(a)!==a||Math.floor(b)!==b||0xffffffffffff<a||0xffffffffffff<b?"#NUM!":a&b},BITLSHIFT:function(a, b){a=parseFloat(a,10);b=parseFloat(b,10);return isNaN(a)||isNaN(b)?"#VALUE!":0>a||Math.floor(a)!==a||0xffffffffffff<a||53<Math.abs(b)?"#NUM!":0<=b?a<<b:a>>-b},BITOR:function(a,b){a=parseFloat(a,10);b=parseFloat(b,10);return isNaN(a)||isNaN(b)?"#VALUE!":0>a||0>b||Math.floor(a)!==a||Math.floor(b)!==b||0xffffffffffff<a||0xffffffffffff<b?"#NUM!":a|b},BITRSHIFT:function(a,b){a=parseFloat(a,10);b=parseFloat(b,10);return isNaN(a)||isNaN(b)?"#VALUE!":0>a||Math.floor(a)!==a||0xffffffffffff<a||53<Math.abs(b)? "#NUM!":0<=b?a>>b:a<<-b},BITXOR:function(a,b){a=parseFloat(a,10);b=parseFloat(b,10);return isNaN(a)||isNaN(b)?"#VALUE!":0>a||0>b||Math.floor(a)!==a||Math.floor(b)!==b||0xffffffffffff<a||0xffffffffffff<b?"#NUM!":a^b},CONVERT:function(a,b,c){if(isNaN(a))return"#VALUE!";for(var d=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?", null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11], ["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot", "ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup", "cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree","\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce", "oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null, "area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton", "LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0, .001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity", !0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1, 9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0, !1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian", "rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4], ["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance", !1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon","tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907], ["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],e={Yi:["yobi", 80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},f={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"], e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},g=null,m=null,h=b,l=c,n=1,p=1,r,q=0;q<d.length;q++){r=null===d[q][2]?[]:d[q][2];if(d[q][1]===h||0<=r.indexOf(h))g=d[q];if(d[q][1]===l||0<=r.indexOf(l))m=d[q]}if(null===g)for(r=e[b.substring(0,2)],q=f[b.substring(0,1)],"da"===b.substring(0,2)&&(q=["dekao",10,"da"]),r?(n=r[2], h=b.substring(2)):q&&(n=q[1],h=b.substring(q[2].length)),b=0;b<d.length;b++)if(r=null===d[b][2]?[]:d[b][2],d[b][1]===h||0<=r.indexOf(h))g=d[b];if(null===m)for(e=e[c.substring(0,2)],f=f[c.substring(0,1)],"da"===c.substring(0,2)&&(f=["dekao",10,"da"]),e?(p=e[2],l=c.substring(2)):f&&(p=f[1],l=c.substring(f[2].length)),c=0;c<d.length;c++)if(r=null===d[c][2]?[]:d[c][2],d[c][1]===l||0<=r.indexOf(l))m=d[c];return null===g||null===m||g[3]!==m[3]?"#N/A":a*g[6]*n/(m[6]*p)}},user_defined:{}},p={toChr:function(a){var b= "";for(a-=1;0<=a;)b=String.fromCharCode(a%26+97)+b,a=Math.floor(a/26)-1;return b.toUpperCase()},toNum:function(a){a=a.split("");var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),c,d,e=0;c=0;for(d=a.length-1;c<a.length;c+=1,d-=1)e+=Math.pow(b.length,d)*(b.indexOf(a[c])+1);return e},cellRange:function(a,b){var c=/[A-Z]+/,d=/[0-9]+/,e=a.toUpperCase(),f=b.toUpperCase(),g=this.toNum(e.match(c)[0]),c=this.toNum(f.match(c)[0]),e=parseInt(e.match(d)[0],10),d=parseInt(f.match(d)[0],10),f=[],m,h;for(h=g;h<=c;h++)for(m= e;m<=d;m++)g=this.toChr(h)+m,f.push(g);return f},isValidBinary:function(a){return/^[01]{1,10}$/.test(a)},strRepeat:function(a,b){if(1>b)return"";for(var c="";0<b;)b&1&&(c+=a),b>>=1,a+=a;return c},repeat:function(a,b,c){if(null==a)return"";b=~~b;if(null==c)return this.strRepeat(String(a),b);for(var d=[];0<b;d[--b]=a);return d.join(c)},unique:function(a){return a.reduce(function(a,c){0>a.indexOf(c)&&a.push(c);return a},[])},arrayMerge:function(a){var b,c,d=[];for(c=0;c<a.length;c++)if("object"==typeof a[c])for(b in a[c])d= d.concat(a[c][b]);else d=d.concat(a[c]);return d},toArray:function(a){return Array.prototype.slice.call(a,0)},cleanFloat:function(a){var b=Math.pow(10,14);return Math.round(a*b)/b},countIn:function(a,b){for(var c=0,d=0;d<a.length;d++)a[d]===b&&c++;return c}},v={MEMOIZED_FACT:[],SQRT2PI:2.5066282746310002,WEEK_STARTS:[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES:[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3, 4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES:[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],DAY_NAME:"Sunday Monday Thuesday Wednesday Thursday Friday Saturday".split(" "),ERROR:"#DIV/0! #N/A #NAME? #NUM! #NULL! #REF! #VALUE!".split(" "),VARIABLE:{}};q.prototype.init=function(){var a=this.el?this.el.attr("data-cell"):"",b=this.el?this.el.attr("data-formula"):"",c=this.el?this.el.attr("data-format"): "",d=this.el?this.el.val():null;a&&""!=n.trim(a)?a=a.toUpperCase():(a="CALX"+this.sheet.counter,this.el&&this.el.attr("data-cell",a),this.sheet.counter++);b=b&&""!=n.trim(b)?b.replace("&quot;",'"').replace("&#39;","'").replace("&#34;",'"'):!1;c&&""!=n.trim(c)||(c=this.sheet.config.defaultFormat);c&&"undefined"!=typeof numeral&&""!=d&&(d=numeral().unformat(d));this.value=d;this.formula=b;this.format=c;this.address=a;this.setValue(d)};q.prototype.buildDependency=function(){var a={remoteCellRange:/\#[A-Za-z0-9_]+\s*>\s*[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g, remoteCell:/\#[A-Za-z0-9_]+\s*>\s*[A-Za-z]+[0-9]+/g,cellRange:/[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g,cell:/[A-Z]+[0-9]+/g},b=this.formula,c="#"+this.sheet.el.attr("id"),d=this.address,e,f,g,m,h,l;for(f in this.dependencies)-1===f.indexOf("#")?this.dependencies[f].removeDependant(d):this.dependencies[f].removeDependant(c+">"+d),delete this.dependencies[f];if(b)for(f in a)if(h=b.match(a[f]),b=b.replace(a[f],""),null!==h)switch(f){case "remoteCellRange":for(d=0;d<h.length;d++)for(g in e=h[d].split(">"), l=n.trim(e[0]),m=e[1].split(":"),e=n.trim(m[0]),m=n.trim(m[1]),e=this.sheet.getRemoteCellRange(l,e,m),e)m=l+">"+g,"undefined"==typeof this.dependencies[m]&&!1!==e[g]&&(this.dependencies[m]=e[g],e[g].registerDependant(c+">"+this.getAddress(),this));break;case "remoteCell":for(d=0;d<h.length;d++)e=h[d].split(">"),l=n.trim(e[0]),m=n.trim(e[1]),e=this.sheet.getRemoteCell(l,m),m=l+">"+m,"undefined"==typeof this.dependencies[m]&&!1!==e&&(this.dependencies[m]=e,e.registerDependant(c+">"+this.getAddress(), this));break;case "cellRange":for(d=0;d<h.length;d++)for(g in m=h[d].split(":"),e=n.trim(m[0]),m=n.trim(m[1]),e=this.sheet.getCellRange(e,m),e)"undefined"==typeof this.dependencies[g]&&!1!==e[g]&&(this.dependencies[g]=e[g],e[g].registerDependant(this.getAddress(),this));break;case "cell":for(d=0;d<h.length;d++)m=h[d],e=this.sheet.getCell(m),"undefined"==typeof this.dependencies[m]&&!1!==e&&(this.dependencies[m]=e,e.registerDependant(this.getAddress(),this))}};q.prototype.removeDependency=function(a){"undefined"!= typeof this.dependencies[a]&&delete this.dependencies[a]};q.prototype.processDependency=function(a,b){a="undefined"==typeof a?!1:a;b="undefined"==typeof b?!1:b;for(var c in this.dependencies)this.dependencies[c].isAffected()&&this.dependencies[c].processDependency(b,b);this.evaluateFormula();this.setAffected(!1);a&&this.renderComputedValue()};q.prototype.registerDependant=function(a,b){"undefined"==typeof this.dependant[a]&&b&&(this.dependant[a]=b)};q.prototype.removeDependant=function(a){"undefined"!= typeof this.dependant[a]&&delete this.dependant[a]};q.prototype.processDependant=function(a,b){a="undefined"==typeof a?!1:a;b="undefined"==typeof b?!1:b;this.evaluateFormula();a&&this.renderComputedValue();for(var c in this.dependant)this.dependant[c].processDependant(b,b)};q.prototype.checkCircularReference=function(a){var b,c=!1;"undefined"==typeof a&&(a=this.getAddress());if(!1!==this.formula){for(b in this.dependencies)if(c=c||b==a)return!0;for(b in this.dependencies)if(c=c||this.dependencies[b].checkCircularReference(a))return!0}return c}; q.prototype.evaluateFormula=function(){this.formula&&(this.computedValue=this.sheet.evaluate(this.formula))};q.prototype.detachEvent=function(){if(!1!==this.el){var a=this.el.prop("tagName").toLowerCase();-1<this.formTags.indexOf(a)&&("input"==a?(this.el.off("claxFocus"),this.el.off("calxBlur")):"select"==a&&this.el.off("calxChange"))}};q.prototype.formTags=["input","select","textarea","button"];q.prototype.setFormat=function(a){this.format=a;!1!==this.el&&this.el.attr("data-format",a)};q.prototype.getFormat= function(){return this.format};q.prototype.setFormula=function(a){this.formula=a;!1!==this.el&&this.el.attr("data-formula",a);this.buildDependency();this.processDependency(!0,!0);this.evaluateFormula()};q.prototype.getFormula=function(){return this.formula};q.prototype.getAddress=function(){return this.address};q.prototype.setValue=function(a,b){this.value=n.isNumeric(a)?parseFloat(a):a;this.formattedValue="";b="undefined"==typeof b?!0:b;this.setAffected(!0);for(var c in this.dependant)this.dependant[c].setAffected(!0); this.processDependant(b,!0)};q.prototype.getValue=function(){return this.formula?this.computedValue:this.value};q.prototype.getStringValue=function(){return this.value+""};q.prototype.getFormattedValue=function(){return this.formattedValue};q.prototype.getFloatValue=function(){return this.floatValue};q.prototype.setAffected=function(a){this.affected="undefined"==typeof a?!0:!1};q.prototype.isAffected=function(){return this.affected};q.prototype.renderComputedValue=function(){if(!1!==this.el){var a= this.el.prop("tagName").toLowerCase(),a=-1<this.formTags.indexOf(a),b;b=this.formula?this.format&&"undefined"!=typeof numeral&&""!==this.computedValue&&-1==v.ERROR.indexOf(this.computedValue)?numeral(this.computedValue).format(this.format):this.computedValue:this.format&&"undefined"!=typeof numeral&&""!==this.computedValue&&-1==v.ERROR.indexOf(this.computedValue)?numeral(this.value).format(this.format):this.value;a?this.el.val(b):this.el.html(b)}};s.prototype.init=function(){var a=this.el.find("[data-cell],[data-formula],[data-format]"), b=this,c;this.parser=E(this);this.el.attr("data-calx-identifier",this.identifier);a.each(function(){c=new q(b,this);b.registerCell(c)});b.attachEvent()};s.prototype.checkCircularReference=function(){var a,b={isCircular:!1,cell:null};for(a in this.cells)if(b.isCircular=this.cells[a].checkCircularReference(),!0===b.isCircular){b.cell=this.cells[a];break}return b};s.prototype.buildCellDependency=function(){for(var a in this.cells)this.cells[a].buildDependency()};s.prototype.processDependencyTree=function(){for(var a in this.cells)this.cells[a].setAffected(!0); for(a in this.cells)this.cells[a].processDependency(!0,!0)};s.prototype.getCellValue=function(a){a=a.toUpperCase();return"undefined"==typeof this.cells[a]?!1:this.cells[a].getValue()};s.prototype.getCellRangeValue=function(a,b){var c=p.cellRange(a,b),d=c.length,e={},f;for(f=0;f<d;f++)e[c[f]]=this.getCellValue(c[f]);return e};s.prototype.getRemoteCellRangeValue=function(a,b,c){return(a=n(a).attr("data-calx-identifier"))&&"undefined"!=typeof r.sheetRegistry[a]?r.sheetRegistry[a].getCellRangeValue(b, c):!1};s.prototype.getRemoteCellValue=function(a,b){var c=n(a).attr("data-calx-identifier");return c&&"undefined"!=typeof r.sheetRegistry[c]?r.sheetRegistry[c].getCellValue(b):!1};s.prototype.getRemoteCellRange=function(a,b,c){return(a=n(a).attr("data-calx-identifier"))&&"undefined"!=typeof r.sheetRegistry[a]?r.sheetRegistry[a].getCellRange(b,c):!1};s.prototype.getRemoteCell=function(a,b){var c=n(a).attr("data-calx-identifier");return c&&"undefined"!=typeof r.sheetRegistry[c]?r.sheetRegistry[c].getCell(b): !1};s.prototype.callFunction=function(a,b){var c,d;d=a.toUpperCase();if("function"==typeof g[d])return g[d].apply(this,b);for(c in g)if("function"==typeof g[c][d])return g[c][d].apply(this,b);return"#NAME?"};s.prototype.time=function(a){var b=a.split(":");a=new Date;var c="undefined"==typeof b[0]?0:b[0],d="undefined"==typeof b[1]?0:b[1],b="undefined"==typeof b[2]?0:b[2];return new Date(a.getFullYear(),a.getMonth(),a.getDate(),c,d,b)};s.prototype.getVariable=function(a){a=a[0];return"undefined"==typeof v.VARIABLE[a]? "#NAME?":v.VARIABLE[a]};s.prototype.comparator={greater:function(a,b){return a>b},equal:function(a,b){return a==b}};s.prototype.obj={type:"cell"};s.prototype.evaluate=function(a){return this.parser.parse(a)};s.prototype.update=function(){};s.prototype.calculate=function(){};s.prototype.registerCell=function(a){this.cells[a.getAddress()]=a};s.prototype.getCell=function(a){return"undefined"!=typeof this.cells[a]?this.cells[a]:!1};s.prototype.getCellRange=function(a,b){var c=p.cellRange(a,b),d=c.length, e={},f;for(f=0;f<d;f++)e[c[f]]=this.getCell(c[f]);return e};s.prototype.applyChange=function(){for(var a in this.cells)this.cells[a].processDependency(!1,!1);for(a in this.cells)this.cells[a].renderComputedValue()};s.prototype.scan=function(){};s.prototype.refresh=function(){};s.prototype.attachEvent=function(){var a=this;this.el.on("calxFocus","input[data-cell]",function(){var b=n(this).attr("data-cell"),b=a.cells[b];b.el.val(b.getValue())});this.el.on("calxBlur","input[data-cell]",function(){var b= n(this).attr("data-cell"),b=a.cells[b];if(b.getFormat()&&"undefined"!=typeof numeral&&""!=b.el.val()&&-1==v.ERROR.indexOf(b.el.val())){var c=numeral().unformat(b.el.val());b.setValue(c)}else b.setValue(b.el.val());b.renderComputedValue();b.processDependant(!1,!0)});this.el.on("calxKeyup","input[data-cell]",function(){var b=n(this).attr("data-cell"),b=a.cells[b];if(b.getFormat()&&"undefined"!=typeof numeral&&""!=b.el.val()&&-1==v.ERROR.indexOf(b.el.val())){var c=numeral().unformat(b.el.val());b.setValue(c, !1)}else b.setValue(b.el.val(),!1)});this.el.on("blur","input[data-cell]",function(){n(this).trigger("calxBlur")});this.el.on("focus","input[data-cell]",function(){n(this).trigger("calxFocus")});this.el.on("keyup","input[data-cell]",function(){n(this).trigger("calxKeyup")})};var r={sheetRegistry:{},init:function(a){var b,c;this.each(function(){(c=n(this).attr("data-calx-identifier"))&&"undefined"!=typeof r.sheetRegistry[c]?r.sheetRegistry[c].refresh():(c="CALX"+(new Date).valueOf(),r.sheetRegistry[c]= new s(c,this,a))});for(b in r.sheetRegistry)r.sheetRegistry[b].buildCellDependency();for(b in r.sheetRegistry){var d=r.sheetRegistry[b].checkCircularReference();d.isCircular&&(d="Circular reference detected, this may cause calx to stop working.\ncell : "+d.cell.getAddress()+"\nformula : "+d.cell.getFormula()+"\n\nPlease check each cells involved in the formula that has direct or indirect reference to "+d.cell.getAddress(),alert(d),n.error(d));r.sheetRegistry[b].processDependencyTree()}return this}, registerFunction:function(a,b,c){if("undefined"==typeof c?0:c)for(var d in g)"undefined"!=typeof g[d][a]&&delete g[d][a];g.user_defined[a]=b},registerVariable:function(a,b){if("object"==typeof a)for(var c in a)v.VARIABLE[c]=a[c];else v.VARIABLE[a]=b},scan:function(a){},update:function(a){},getSheet:function(){var a=n(this).attr("data-calx-identifier");return"undefined"==typeof r.sheetRegistry[a]?!1:r.sheetRegistry[a]},getCell:function(a){var b=n(this).attr("data-calx-identifier");$sheet=r.sheetRegistry[b]; return $sheet.getCell(a)},evaluate:function(a){var b=n(this).attr("data-calx-identifier");$sheet=r.sheetRegistry[b];return $sheet.evaluate(a)},destroy:function(){this.each(function(){var a=n(this),b,c=a.attr("data-calx-identifier");a.removeAttr("data-calx-identifier");for(b in r.sheetRegistry[c].cells)r.sheetRegistry[c].cells[b].detachEvent();delete r.sheetRegistry[c]});return this}};n.fn.calx=function(a,b){if(r[a])return r[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof a|| "undefined"==typeof a)return r.init.apply(this,arguments);n.error("Method "+method+" does not exist on jQuery.calx")}})(jQuery);